# Kubernetes Cluster Architecture & Core Components

## 1. Kubernetes í´ëŸ¬ìŠ¤í„° ì•„í‚¤í…ì²˜ ê°œìš”

KubernetesëŠ” **ì»¨í…Œì´ë„ˆ ê¸°ë°˜ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ìë™ ë°°í¬, ìŠ¤ì¼€ì¤„ë§, í™•ì¥, ìš´ì˜**ì„ ìœ„í•œ ì˜¤í”ˆì†ŒìŠ¤ í”Œë«í¼ì´ë‹¤. ì´ ì‹œìŠ¤í…œì€ ë‘ ê°€ì§€ í•µì‹¬ êµ¬ì„±ìš”ì†Œë¡œ ë‚˜ë‰œë‹¤:

- **Control Plane (ë§ˆìŠ¤í„° ë…¸ë“œ)**
- **Worker Nodes (ì‘ì—…ì ë…¸ë“œ)**

ì´ êµ¬ì¡°ëŠ” â€œì»¨í…Œì´ë„ˆ ì„ ë°•(ë…¸ë“œ) + ê´€ì œ ì‹œìŠ¤í…œ(ë§ˆìŠ¤í„°)â€ì— ë¹„ìœ 

## 2. ì£¼ìš” êµ¬ì„± ìš”ì†Œ ìš”ì•½

### âœ… Control Plane êµ¬ì„± ìš”ì†Œ

| êµ¬ì„± ìš”ì†Œ | ì—­í•  |
| --- | --- |
| **etcd** | í´ëŸ¬ìŠ¤í„° ìƒíƒœë¥¼ ì €ì¥í•˜ëŠ” ê³ ê°€ìš© í‚¤-ê°’ DB (ë©”íƒ€ë°ì´í„° ì €ì¥ì†Œ) |
| **kube-apiserver** | í´ëŸ¬ìŠ¤í„°ì™€ì˜ ëª¨ë“  í†µì‹ ì„ ì¤‘ê°œí•˜ëŠ” ì¤‘ì•™ API ê²Œì´íŠ¸ì›¨ì´ |
| **kube-scheduler** | ìƒˆë¡œ ìƒì„±ëœ Podì— ì ì ˆí•œ Nodeë¥¼ í• ë‹¹ |
| **kube-controller-manager** | í´ëŸ¬ìŠ¤í„° ìƒíƒœë¥¼ ëª¨ë‹ˆí„°ë§í•˜ê³  ì›í•˜ëŠ” ìƒíƒœë¥¼ ìœ ì§€í•˜ë„ë¡ ì¡°ì¹˜ |
| **cloud-controller-manager** | (í´ë¼ìš°ë“œ ì‚¬ìš© ì‹œ) í´ë¼ìš°ë“œ ë¦¬ì†ŒìŠ¤ì™€ì˜ ì—°ë™ì„ ë‹´ë‹¹ |

> â˜ï¸ Kube-apiserverë¥¼ í†µí•´ ëª¨ë“  ëª…ë ¹ì´ ë“¤ì–´ì˜¤ë©°, etcdëŠ” í´ëŸ¬ìŠ¤í„°ì˜ ëª¨ë“  ìƒíƒœë¥¼ ë³´ì¡´í•œë‹¤.
>

### âœ… Node êµ¬ì„± ìš”ì†Œ

| êµ¬ì„± ìš”ì†Œ | ì—­í•  |
| --- | --- |
| **kubelet** | ê° ë…¸ë“œì— ìƒì£¼í•˜ë©°, API ì„œë²„ì˜ ëª…ë ¹ì— ë”°ë¼ ì»¨í…Œì´ë„ˆë¥¼ ì‹¤í–‰ ë° ìƒíƒœ ë¦¬í¬íŒ… |
| **kube-proxy** | ë„¤íŠ¸ì›Œí¬ íŠ¸ë˜í”½ì„ ê´€ë¦¬í•˜ë©°, ì„œë¹„ìŠ¤ IP/í¬íŠ¸ë¡œ í¬ì›Œë”©í•˜ëŠ” ì—­í•  ìˆ˜í–‰ |
| **Container Runtime** | ì»¨í…Œì´ë„ˆ ì‹¤í–‰ í™˜ê²½ (ì˜ˆ: Docker, containerd ë“±) |

> kubeletì€ 'ì„ ì¥'ì— ë¹„ìœ  â†’ ë…¸ë“œ ë‚´ ì»¨í…Œì´ë„ˆë¥¼ ê´€ë¦¬í•˜ê³  ë§ˆìŠ¤í„°ì™€ í†µì‹ .
>

## 3. ê° êµ¬ì„± ìš”ì†Œ ì„¸ë¶€ ê¸°ëŠ¥ ìš”ì•½

### kube-apiserver

- Kubernetes APIë¥¼ ì™¸ë¶€ ë° ë‚´ë¶€ì— ë…¸ì¶œ
- ëª¨ë“  REST ìš”ì²­ì˜ ì…ì¶œêµ¬
- ì¸ì¦, ê¶Œí•œë¶€ì—¬, ìœ íš¨ì„± ê²€ì‚¬ ë“± ìˆ˜í–‰

### etcd

- í´ëŸ¬ìŠ¤í„° ìƒíƒœ ì €ì¥ì†Œ (ëª¨ë“  ì˜¤ë¸Œì íŠ¸ ì •ì˜ í¬í•¨)
- ê³ ê°€ìš© í‚¤-ê°’ ì €ì¥ì†Œ
- `kubectl get` ëª…ë ¹ ê²°ê³¼ëŠ” etcdì—ì„œ ê°€ì ¸ì˜´

### kube-scheduler

- ìƒˆ Podì— ì•Œë§ì€ ë…¸ë“œë¥¼ ì„ íƒ
- ê³ ë ¤ ìš”ì†Œ: ë¦¬ì†ŒìŠ¤ ìš”êµ¬ì‚¬í•­, íƒœì¸íŠ¸/í†¨ëŸ¬ë ˆì´ì…˜, affinity ë“±

### kube-controller-manager

- ì—¬ëŸ¬ ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ í•œ í”„ë¡œì„¸ìŠ¤ë¡œ ì‹¤í–‰:
    - Node Controller
    - Replication Controller
    - Namespace Controller
    - Endpoints Controller ë“±
- ìƒíƒœë¥¼ ëª¨ë‹ˆí„°ë§í•˜ê³  ìˆ˜ì •í•¨ (desired state ìœ ì§€)

## kubelet & kube-proxy

| í•­ëª© | ì„¤ëª… |
| --- | --- |
| **kubelet** | ë…¸ë“œ ë‚´ì—ì„œ Podì™€ ì»¨í…Œì´ë„ˆ ìƒíƒœë¥¼ ê´€ë¦¬ |
| **kube-proxy** | ì„œë¹„ìŠ¤ IPì™€ ì‹¤ì œ Pod IP ê°„ì˜ íŠ¸ë˜í”½ì„ ì—°ê²° |

## âš™ï¸ Container Runtime ë¹„êµ (Docker vs Containerd)

- KubernetesëŠ” CRI(Container Runtime Interface)ë¥¼ ì‚¬ìš©í•´ ë‹¤ì–‘í•œ ëŸ°íƒ€ì„ê³¼ ì—°ë™
- ì‚¬ìš© ê°€ëŠ¥í•œ ëŸ°íƒ€ì„: `Docker`, `containerd`, `CRI-O`
- v1.24 ì´í›„, `dockershim`ì´ ì œê±°ë˜ì–´ containerd ë˜ëŠ” CRI-Oë¡œ ì „í™˜ í•„ìš”

## ì£¼ìš” ëª…ë ¹ì–´

```bash

kubectl get nodes
kubectl get pods -A
kubectl describe pod <pod-name>
kubectl get componentstatuses

```

etcd ë°ì´í„° í™•ì¸ ì˜ˆì‹œ:

```bash

kubectl exec etcd-master -n kube-system -- etcdctl get / --prefix --keys-only

```

---

# Dockerì™€ Containerdì˜ ê´€ê³„

### âœ… DockerëŠ” ì¢…í•© íˆ´í‚·

DockerëŠ” ë‹¨ìˆœí•œ ì»¨í…Œì´ë„ˆ ëŸ°íƒ€ì„ì´ ì•„ë‹ˆë¼ ì—¬ëŸ¬ ê¸°ëŠ¥ì´ í†µí•©ëœ í”Œë«í¼:

- Docker CLI (ëª…ë ¹ì–´ ì¸í„°í˜ì´ìŠ¤)
- Docker API
- ì´ë¯¸ì§€ ë¹Œë“œ ë„êµ¬
- ì¸ì¦/ë³´ì•ˆ ëª¨ë“ˆ
- ì»¨í…Œì´ë„ˆ ëŸ°íƒ€ì„ (containerd + runc)

â†’ ì¿ ë²„ë„¤í‹°ìŠ¤ ì…ì¥ì—ì„œ DockerëŠ” "ë³µí•© í”Œë«í¼"ì´ë©°, ì¿ ë²„ë„¤í‹°ìŠ¤ê°€ í•„ìš”ë¡œ í•˜ëŠ” ê²ƒì€ ê·¸ì¤‘ *containerd* ê°™ì€ "ëŸ°íƒ€ì„" ë¶€ë¶„ì´ë‹¤.

## 2. ì¿ ë²„ë„¤í‹°ìŠ¤ì—ì„œ Dockerê°€ ì œê±°ëœ ì´ìœ 

| í•­ëª© | ì„¤ëª… |
| --- | --- |
| **ì´ˆê¸°** | KubernetesëŠ” Dockerë§Œ ì§€ì› (dockershimì„ í†µí•´ ì—°ê²°) |
| **ì¤‘ê°„** | ë‹¤ì–‘í•œ ëŸ°íƒ€ì„ ì§€ì› ìœ„í•´ CRI(Container Runtime Interface) ë„ì… |
| **ê²°ì •** | v1.24ë¶€í„° `dockershim` ì œê±° â†’ Docker ì§€ì› ì¤‘ë‹¨ |
| **ê²°ë¡ ** | KubernetesëŠ” ì´ì œ **containerd**, **CRI-O** ë“±ì˜ CRI-í˜¸í™˜ ëŸ°íƒ€ì„ë§Œ ì§ì ‘ ì§€ì›í•¨ |

*í•˜ì§€ë§Œ Dockerë¡œ ë§Œë“  ì´ë¯¸ì§€ëŠ” OCI í‘œì¤€ì„ ë”°ë¥´ë¯€ë¡œ containerd ë“±ì—ì„œ ê³„ì† ì‚¬ìš© ê°€ëŠ¥í•˜ë‹¤.*

## 3. Container Runtime Interface (CRI)

### ëª©ì 

- ë‹¤ì–‘í•œ ì»¨í…Œì´ë„ˆ ëŸ°íƒ€ì„ê³¼ ì¿ ë²„ë„¤í‹°ìŠ¤ê°€ **ê³µí†µ ì¸í„°í˜ì´ìŠ¤(CRI)**ë¥¼ í†µí•´ ì—°ë™ ê°€ëŠ¥í•˜ê²Œ í•¨.

### OCI(Open Container Initiative)

- ì´ë¯¸ì§€ ë° ëŸ°íƒ€ì„ í‘œì¤€ ì œê³µ (image spec, runtime spec)
- Docker, containerd, CRI-O ë“±ì´ ì´ë¥¼ ë”°ë¦„

## 4. ì£¼ìš” ì»¨í…Œì´ë„ˆ CLI ë„êµ¬ ë¹„êµ

| CLI ë„êµ¬ | ì£¼ì²´ | ìš©ë„ | íŠ¹ì„± |
| --- | --- | --- | --- |
| `ctr` | containerd | ë””ë²„ê¹… ì „ìš© | ê¸°ëŠ¥ ì œí•œ, ì‚¬ìš©ì ì¹œí™”ì  X |
| `nerdctl` | containerd | Docker ëŒ€ì²´ìš© ì¼ë°˜ CLI | Docker CLIì™€ ìœ ì‚¬, composeë„ ì§€ì› |
| `crictl` | Kubernetes | CRI ê¸°ë°˜ ëŸ°íƒ€ì„ ë””ë²„ê¹… | í¬ë“œ/ì»¨í…Œì´ë„ˆ ì¡°íšŒ ê°€ëŠ¥, ë””ë²„ê¹… ì „ìš© |

---

### `ctr` ì˜ˆì‹œ (ì œí•œì , ë””ë²„ê¹… ì¤‘ì‹¬)

```bash

$ ctr images pull docker.io/library/redis:alpine
$ ctr run docker.io/library/redis:alpine redis

```

- ë‹¨ìˆœí•œ ë””ë²„ê¹…/í…ŒìŠ¤íŠ¸ ëª©ì 
- ì‹¤ì„œë¹„ìŠ¤ì—ëŠ” ì í•©í•˜ì§€ ì•ŠìŒ

---

### `nerdctl` ì˜ˆì‹œ (Docker ëŒ€ì²´)

```bash

$ nerdctl run --name redis redis:alpine
$ nerdctl run --name webserver -p 80:80 -d nginx

```

- **Docker CLIì™€ ê±°ì˜ ë™ì¼**
- docker-compose, ì´ë¯¸ì§€ ì„œëª…, ì•”í˜¸í™” ì´ë¯¸ì§€, Lazy Pulling ë“± ìµœì‹  containerd ê¸°ëŠ¥ ì‚¬ìš© ê°€ëŠ¥

---

### `crictl` ì˜ˆì‹œ (Kubernetes ê¸°ì¤€ ë””ë²„ê¹… ë„êµ¬)

```bash

$ crictl pull busybox
$ crictl ps -a
$ crictl logs <container-id>
$ crictl pods

```

- CRI í˜¸í™˜ ëŸ°íƒ€ì„ ëª¨ë‘ ì§€ì› (containerd, CRI-O ë“±)
- **Pod ë ˆë²¨ ë””ë²„ê¹… ê°€ëŠ¥**
- Docker CLIì™€ ìœ ì‚¬í•œ ë¬¸ë²•

ğŸ’¡ *ì£¼ì˜: crictlë¡œ ë§Œë“  ì»¨í…Œì´ë„ˆëŠ” kubeletì´ ê´€ë¦¬í•˜ì§€ ì•Šìœ¼ë©´ ì‚­ì œë¨ (ì¿ ë²„ë„¤í‹°ìŠ¤ ê´€ì  ì™¸ ì»¨í…Œì´ë„ˆëŠ” ë¬´íš¨)*

## 5. ìš”ì•½ ë¹„êµ

| í•­ëª© | ctr | nerdctl | crictl |
| --- | --- | --- | --- |
| ì†Œì† | containerd | containerd | Kubernetes |
| ëª©ì  | ë””ë²„ê¹… | ì¼ë°˜ CLI | CRI ê¸°ë°˜ ë””ë²„ê¹… |
| ì‚¬ìš©ì„± | ë¶ˆí¸í•¨ | Docker ëŒ€ì²´ ê°€ëŠ¥ | ë””ë²„ê¹… ì „ìš© |
| ì»¨í…Œì´ë„ˆ ìƒì„± | O | O | ê°€ëŠ¥í•˜ì§€ë§Œ ë¹„ì¶”ì²œ |
| ì‚¬ìš© ê¶Œì¥ë„ | âŒ | âœ… | âœ… (ë””ë²„ê¹… í•œì •) |

# etcd ì´í•´ ë° í™œìš©

## 1. etcdë€ ë¬´ì—‡ì¸ê°€?

- **etcd**ëŠ” Kubernetesì˜ í´ëŸ¬ìŠ¤í„° ìƒíƒœ ì •ë³´ë¥¼ ì €ì¥í•˜ëŠ” **ê³ ê°€ìš©ì„± ë¶„ì‚° Key-Value ì €ì¥ì†Œ**ì´ë‹¤.
- **ì‹¬í”Œ, ì•ˆì „, ë¹ ë¦„ (Simple, Secure, Fast)** ì´ë¼ëŠ” íŠ¹ì§•ì„ ê°€ì§.
- í´ëŸ¬ìŠ¤í„°ì˜ ëª¨ë“  ì˜¤ë¸Œì íŠ¸ ì •ë³´(ì˜ˆ: Pods, Configs, Secrets, ServiceAccount ë“±)ê°€ ì €ì¥ë¨.

## 2. Key-Value Storeë€?

### RDBMS vs Key-Value Store

| RDBMS | Key-Value Store (etcd) |
| --- | --- |
| í…Œì´ë¸” ê¸°ë°˜ (í–‰/ì—´ êµ¬ì¡°) | ê°œë³„ JSON/ë¬¸ì„œ ë‹¨ìœ„ |
| ê³µí†µ í•„ë“œê°€ í•„ìˆ˜ | ê°œë³„ ì—”íŠ¸ë¦¬ë§ˆë‹¤ ë‹¤ë¥¸ êµ¬ì¡° ê°€ëŠ¥ |
| ìƒˆë¡œìš´ ì •ë³´ê°€ ì „ì²´ í…Œì´ë¸”ì— ì˜í–¥ | ë‹¤ë¥¸ ì—”íŠ¸ë¦¬ì— ì˜í–¥ ì—†ìŒ |
| ë³µì¡í•œ JOIN ì—°ì‚° ê°€ëŠ¥ | ë‹¨ìˆœ ì¿¼ë¦¬ ë° íŠ¸ëœì­ì…˜ ì¤‘ì‹¬ |

etcdëŠ” JSON í˜¹ì€ YAMLê³¼ ê°™ì€ í¬ë§·ìœ¼ë¡œ ë™ì‘í•˜ë©°, **ê° ë¦¬ì†ŒìŠ¤ë¥¼ ë…ë¦½ì ìœ¼ë¡œ ê´€ë¦¬**í•  ìˆ˜ ìˆë‹¤.

---

## 3. etcd ì„¤ì¹˜ ë° ì‹¤í–‰

### ì„¤ì¹˜ ì ˆì°¨ ìš”ì•½ (ë¡œì»¬ í…ŒìŠ¤íŠ¸ ê¸°ì¤€)

```bash

# 1. ë‹¤ìš´ë¡œë“œ
curl -L https://github.com/etcd-io/etcd/releases/download/v3.3.11/etcd-v3.3.11-linux-amd64.tar.gz -o etcd-v3.3.11-linux-amd64.tar.gz

# 2. ì••ì¶• í•´ì œ
tar xzvf etcd-v3.3.11-linux-amd64.tar.gz

# 3. etcd ì‹¤í–‰
./etcd

```

- ê¸°ë³¸ í¬íŠ¸: `2379`
- etcd ì‹¤í–‰ í›„, í´ë¼ì´ì–¸íŠ¸(`etcdctl`)ë¡œ ì ‘ì† ê°€ëŠ¥

## 4. etcdctl ê¸°ë³¸ ì‚¬ìš©ë²•

### ğŸ”‘ Key-Value ì €ì¥/ì¡°íšŒ

```bash

# Key-Value ì €ì¥
./etcdctl set key1 value1        # (v2 ë°©ì‹)
./etcdctl put key1 value1        # (v3 ë°©ì‹)

# Key ì¡°íšŒ
./etcdctl get key1               # (ê³µí†µ)

```

### ë²„ì „ë³„ ì°¨ì´ (v2 vs v3)

| í•­ëª© | ì„¤ëª… |
| --- | --- |
| `etcd` ìì²´ ë²„ì „ | 3.3.x ë“± |
| `etcdctl` CLI ë²„ì „ | v2ì™€ v3 ëª¨ë‘ ê°€ëŠ¥ |
| `API ë²„ì „` | CLIì™€ ë³„ë„ ì„¤ì • í•„ìš” (`ETCDCTL_API`) |

### í™˜ê²½ë³€ìˆ˜ ì„¤ì • ì˜ˆì‹œ

```bash

# v3 API ì‚¬ìš©
export ETCDCTL_API=3

# ì €ì¥
./etcdctl put name "etcd-user"

# ì¡°íšŒ
./etcdctl get name

```

ETCDCTL_API=3 ì„¤ì • ì—†ìœ¼ë©´ ê¸°ë³¸ì€ v2 ëª¨ë“œë¡œ ì‘ë™í•  ìˆ˜ ìˆìŒ

## 5. etcdì˜ ë²„ì „ ì—­ì‚¬

| ë²„ì „ | ì£¼ìš” íŠ¹ì§• |
| --- | --- |
| v0.1 (2013) | ì´ˆê¸° ê³µê°œ |
| v2.0 (2015) | RAFT í•©ì˜ ì•Œê³ ë¦¬ì¦˜ ë„ì…, ê¸°ë³¸ ì•ˆì • ë²„ì „ |
| v3.0 (2017) | ì„±ëŠ¥ ë° êµ¬ì¡° ê°œì„ , ìƒˆë¡œìš´ API ë„ì… |
| 2018 | CNCF í”„ë¡œì íŠ¸ë¡œ ì¡¸ì—… |

ğŸ§  **v2 â†’ v3**ë¡œì˜ ì „í™˜ì€ ì»¤ë§¨ë“œ ë°©ì‹ê³¼ API êµ¬ì¡°ì˜ ë³€ê²½ì´ í•µì‹¬ì´ë‹¤.

## ğŸ” 6. ê³ ê°€ìš©ì„± êµ¬ì„±ê³¼ RAFT ê°œë…

- etcdëŠ” ë¶„ì‚° ì‹œìŠ¤í…œìœ¼ë¡œ, í´ëŸ¬ìŠ¤í„° ëª¨ë“œì—ì„œ **RAFT í•©ì˜ ì•Œê³ ë¦¬ì¦˜**ì„ í†µí•´ ë°ì´í„°ë¥¼ ë³µì œí•˜ê³  ë™ê¸°í™”í•¨
- ì•ˆì •ì„±ì„ ìœ„í•´ ì¼ë°˜ì ìœ¼ë¡œ **3, 5ê°œì˜ etcd ë…¸ë“œ**ê°€ ê¶Œì¥ë¨
- í–¥í›„ CKA ê³ ê¸‰ ì„¹ì…˜(Cluster Maintenance, Troubleshooting ë“±)ì—ì„œ ìì„¸íˆ ë‹¤ë£¸

---

# ETCDì™€ Kubernetes í´ëŸ¬ìŠ¤í„° êµ¬ì„±

## 1. ETCDë€?

- **ETCDëŠ” Kubernetesì˜ í•µì‹¬ ë°ì´í„° ì €ì¥ì†Œ**
- í´ëŸ¬ìŠ¤í„°ì˜ **ëª¨ë“  ìƒíƒœ ì •ë³´**(ë…¸ë“œ, íŒŒë“œ, ì„œë¹„ìŠ¤, ì‹œí¬ë¦¿ ë“±)ë¥¼ key-value í˜•ì‹ìœ¼ë¡œ ì €ì¥í•œë‹¤.
- `kubectl` ëª…ë ¹ìœ¼ë¡œ ì¡°íšŒë˜ëŠ” ì •ë³´ëŠ” ëª¨ë‘ ETCDì—ì„œ ê°€ì ¸ì˜¨ë‹¤.

## 2.ETCDì™€ í´ëŸ¬ìŠ¤í„° ìƒíƒœ

- í´ëŸ¬ìŠ¤í„°ì˜ ëª¨ë“  ë³€ê²½ì‚¬í•­(ë…¸ë“œ ì¶”ê°€, íŒŒë“œ ë°°í¬ ë“±)ì€ ETCDì— ì €ì¥ë˜ì–´ì•¼ë§Œ **ì •ìƒì ìœ¼ë¡œ ì™„ë£Œëœ ê²ƒ**ìœ¼ë¡œ ê°„ì£¼ë¨.
- **ì¤‘ì•™ ì§‘ì¤‘ì‹ ìƒíƒœ ì €ì¥ì†Œ**ë¡œì¨, í´ëŸ¬ìŠ¤í„°ì˜ ì‹ ë¢°ì„±ê³¼ ì¼ê´€ì„±ì„ ìœ ì§€í•˜ëŠ” ì—­í• ì„ í•œë‹¤.

## 3. ğŸ› ï¸ Kubernetes í´ëŸ¬ìŠ¤í„° ë°°í¬ ë°©ì‹

| ë°©ë²• | ì„¤ëª… | íŠ¹ì§• |
| --- | --- | --- |
| From Scratch | ìˆ˜ë™ìœ¼ë¡œ ë°”ì´ë„ˆë¦¬ë¥¼ ì„¤ì¹˜í•˜ì—¬ í´ëŸ¬ìŠ¤í„° êµ¬ì„± | ìœ ì—°ì„± â†‘, í•™ìŠµ ëª©ì ì— ì í•© |
| kubeadm | ê³µì‹ CLI íˆ´ë¡œ ìë™í™”ëœ í´ëŸ¬ìŠ¤í„° ì´ˆê¸°í™” | ìš´ì˜ì— ì í•©, ì¸ì¦ì„œ ìë™ êµ¬ì„± |
- **ì‹¤ìŠµí™˜ê²½ì—ì„œëŠ” kubeadm ì‚¬ìš©**
- **ì‹œí—˜ì—ì„œëŠ” ë‘˜ ë‹¤ ì•Œì•„ì•¼ í•¨** (íŠ¹íˆ êµ¬ì„± ìš”ì†Œê°€ ì–´ë–»ê²Œ ì—°ê²°ë˜ëŠ”ì§€)

## 4.ì¸ì¦ì„œ (TLS Certificates)

- ETCD, API Server ë“± ì£¼ìš” ì»´í¬ë„ŒíŠ¸ëŠ” TLS ì¸ì¦ì„œë¥¼ ì´ìš©í•˜ì—¬ **ë³´ì•ˆ í†µì‹ **ì„ í•œë‹¤.
- `kubeadm`ì€ ì¸ì¦ì„œë¥¼ ìë™ ìƒì„±í•˜ì§€ë§Œ, ìŠ¤í¬ë˜ì¹˜ ì„¤ì¹˜ ì‹œ ìˆ˜ë™ êµ¬ì„± í•„ìš”.
- ETCDëŠ” ë³´í†µ 2379 í¬íŠ¸ë¥¼ ì‚¬ìš©í•˜ë©°, API ì„œë²„ëŠ” `-etcd-servers` í”Œë˜ê·¸ë¡œ ì—°ê²° ì„¤ì •.

## 5. ETCD íƒìƒ‰ê³¼ í‚¤ êµ¬ì¡°

- ETCDëŠ” `/registry` ë””ë ‰í† ë¦¬ë¥¼ ë£¨íŠ¸ë¡œ í•˜ì—¬ ê° ë¦¬ì†ŒìŠ¤ë¥¼ ì €ì¥í•¨:

```

/registry/nodes/
/registry/pods/
/registry/deployments/
/registry/secrets/

```

- `etcdctl`ë¡œ í‚¤ ì—´ëŒ ê°€ëŠ¥:

```bash

etcdctl get /registry --prefix --keys-only

```

## 6. ğŸ§© ê³ ê°€ìš©ì„±(HA) êµ¬ì„±ì—ì„œì˜ ETCD

- HA í™˜ê²½ì—ì„œëŠ” **ë‹¤ìˆ˜ì˜ ë§ˆìŠ¤í„° ë…¸ë“œì— ê°ê° ETCD ì¸ìŠ¤í„´ìŠ¤ê°€ ë°°í¬**ë¨.
- ì´ë•Œ ETCD ì¸ìŠ¤í„´ìŠ¤ë“¤ì€ ì„œë¡œë¥¼ ì¸ì‹í•˜ê³  í†µì‹ í•  ìˆ˜ ìˆë„ë¡ ì„¤ì •í•´ì•¼ í•¨:

### í•„ìˆ˜ íŒŒë¼ë¯¸í„°

| íŒŒë¼ë¯¸í„° | ì„¤ëª… |
| --- | --- |
| `initial-cluster` | í´ëŸ¬ìŠ¤í„°ë¥¼ êµ¬ì„±í•  ë©¤ë²„ë“¤ì˜ ë¦¬ìŠ¤íŠ¸ |
| `initial-advertise-peer-urls` | ì„œë¡œ í†µì‹ í•  ìˆ˜ ìˆëŠ” ì£¼ì†Œ |
| `initial-cluster-state` | `new` or `existing` (ì´ˆê¸°í™” ì—¬ë¶€) |
- ì´ ì„¤ì •ë“¤ì€ **í´ëŸ¬ìŠ¤í„° ì´ˆê¸°í™” ì‹œì ì—ë§Œ ìœ íš¨**í•˜ë©°, ë³€ê²½ ì‹œ ì£¼ì˜ í•„ìš”.

## ğŸ”‘ í•µì‹¬ ê°œë… ì •ë¦¬

| í•­ëª© | ì„¤ëª… |
| --- | --- |
| ETCD | Kubernetes ìƒíƒœ ì €ì¥ì†Œ (key-value) |
| í´ëŸ¬ìŠ¤í„° ë³€ê²½ ë°˜ì˜ ì¡°ê±´ | ETCDì— ë°˜ì˜ë˜ì–´ì•¼ ì ìš© ì™„ë£Œ |
| ë°°í¬ ë°©ì‹ | ìŠ¤í¬ë˜ì¹˜(ìˆ˜ë™) / kubeadm(ìë™) |
| ì¸ì¦ | TLS ì¸ì¦ì„œ í•„ìš” |
| í¬íŠ¸ | ê¸°ë³¸ 2379 (ETCD) |
| ê³ ê°€ìš©ì„± | ì—¬ëŸ¬ ì¸ìŠ¤í„´ìŠ¤ + ì´ˆê¸° í´ëŸ¬ìŠ¤í„° ì„¤ì • í•„ìš” |

---

## kube-apiserver

### 1.  kube-apiserverë€?

- **Kubernetesì˜ í•µì‹¬ ê´€ë¦¬ êµ¬ì„± ìš”ì†Œ**
- ëª¨ë“  í´ëŸ¬ìŠ¤í„° êµ¬ì„± ìš”ì†Œë“¤ì´ í†µì‹ í•˜ëŠ” **ì¤‘ì•™ í—ˆë¸Œ (Single Source of Truth)**
- `kubectl`, `controller`, `scheduler`, `kubelet` ë“± ëª¨ë“  ì»´í¬ë„ŒíŠ¸ëŠ” **kube-apiserverë¥¼ í†µí•´ì„œë§Œ** ETCDë‚˜ í´ëŸ¬ìŠ¤í„°ì— ì ‘ê·¼ ê°€ëŠ¥

### 2. ê¸°ë³¸ ë™ì‘ íë¦„

1. **`kubectl` ì‹¤í–‰ â†’ kube-apiserverë¡œ ìš”ì²­ ì „ì†¡**
2. kube-apiserverëŠ” ë‹¤ìŒì„ ìˆ˜í–‰:
    - ğŸ” **ì¸ì¦(Authentication)** í™•ì¸
    - âœ… **ìš”ì²­ ìœ íš¨ì„±(Authorization, Admission)** í™•ì¸
3. ì´í›„ ìš”ì²­ ë‚´ìš©ì— ë”°ë¼ ì²˜ë¦¬:
    - ETCDì—ì„œ ë°ì´í„° ì¡°íšŒ / ìƒì„± / ë³€ê²½
    - ìƒˆë¡œìš´ ë¦¬ì†ŒìŠ¤ë¥¼ ìƒì„± (ì˜ˆ: Pod ìƒì„± ìš”ì²­)
4. kube-apiserverëŠ” ê²°ê³¼ë¥¼ **ë‹¤ë¥¸ êµ¬ì„±ìš”ì†Œë“¤ì—ê²Œ ì „ë‹¬**
    - `kube-scheduler`ëŠ” unscheduled Podë¥¼ ê°ì§€í•˜ê³  ìŠ¤ì¼€ì¤„ë§ ìˆ˜í–‰
    - `kubelet`ì€ ìì‹ ì˜ Nodeì— í• ë‹¹ëœ Podë¥¼ ì‹¤í–‰
    - ëª¨ë“  êµ¬ì„± ìš”ì†ŒëŠ” ìƒíƒœë¥¼ kube-apiserverì— ì§€ì†ì ìœ¼ë¡œ ë³´ê³ 

### 3. API ì§ì ‘ í˜¸ì¶œë„ ê°€ëŠ¥

- ê¼­ `kubectl` ëª…ë ¹ì–´ê°€ ì•„ë‹ˆë¼, **HTTP POST ìš”ì²­ìœ¼ë¡œë„ Kubernetes API í˜¸ì¶œ ê°€ëŠ¥**
- ex) Pod ìƒì„± ì‹œ, ì¸ì¦ ë° ìœ íš¨ì„± ê²€ì‚¬ëŠ” ë™ì¼í•˜ê²Œ ìˆ˜í–‰ë¨

### 4. ì‹¤í–‰ ë°©ì‹ ë° êµ¬ì„± ìœ„ì¹˜

| ì„¤ì • ë°©ì‹ | ì„¤ëª… |
| --- | --- |
| `kubeadm` ì‚¬ìš© ì‹œ | `kube-apiserver`ëŠ” `kube-system` ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì˜ Podë¡œ ë°°í¬ë¨ |
| ì‹¤í–‰ íŒŒì¼ ìœ„ì¹˜ | `/etc/kubernetes/manifests/kube-apiserver.yaml` |
| ë¹„-kubeadm ìˆ˜ë™ ì„¤ì¹˜ | `systemd` ì„œë¹„ìŠ¤ë¡œ ë“±ë¡ë˜ì–´ ì‹¤í–‰ë˜ë©°, ì„¤ì •ì€ `/etc/systemd/system/kube-apiserver.service` ë“±ì— ìœ„ì¹˜í•  ìˆ˜ ìˆìŒ |

### 5. ì¸ì¦/ë³´ì•ˆ êµ¬ì„± ìš”ì†Œ

- kube-apiserverëŠ” **ëª¨ë“  ìš”ì²­ì— ëŒ€í•´ ì¸ì¦, ê¶Œí•œ ê²€ì¦, ë³´ì•ˆ ì²˜ë¦¬**ë¥¼ ìˆ˜í–‰
- êµ¬ì„±ìš”ì†Œ ê°„ í†µì‹ ì€ **SSL/TLS ì¸ì¦ì„œ ê¸°ë°˜**ìœ¼ë¡œ ì´ë¤„ì§
    - ì˜ˆ: scheduler â†’ apiserver / controller-manager â†’ apiserver
- ì¸ì¦ì„œ ìœ„ì¹˜ ë° êµ¬ì„±ì€ í–¥í›„ "ë³´ì•ˆ ì„¹ì…˜"ì—ì„œ ë” ìì„¸íˆ ë‹¤ë£¸

---

# kube-controller-manager

## ì—­í•  (What is it?)

- ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ì˜ ë‹¤ì–‘í•œ **ì»¨íŠ¸ë¡¤ëŸ¬(controller)**ë“¤ì„ ì‹¤í–‰í•˜ê³  ê´€ë¦¬í•˜ëŠ” í•µì‹¬ ì»´í¬ë„ŒíŠ¸
- ì»¨íŠ¸ë¡¤ëŸ¬ = í´ëŸ¬ìŠ¤í„° ìƒíƒœë¥¼ ì§€ì†ì ìœ¼ë¡œ ê°ì‹œí•˜ê³  ì›í•˜ëŠ” ìƒíƒœë¡œ **ìë™ ì¡°ì •**í•˜ëŠ” ê´€ë¦¬ì
- kube-apiserverì™€ ì—°ë™í•˜ì—¬ ëª¨ë“  ì¡°ì¹˜ë¥¼ ìˆ˜í–‰í•¨

## ì£¼ìš” ì»¨íŠ¸ë¡¤ëŸ¬ ì˜ˆì‹œ (ëª¨ë‹ˆí„°ë§ + ì¡°ì • ê¸°ëŠ¥)

| ì»¨íŠ¸ë¡¤ëŸ¬ | ì„¤ëª… |
| --- | --- |
| **Node Controller** | ë…¸ë“œ ìƒíƒœ ê°ì‹œ â†’ ë…¸ë“œê°€ ì‘ë‹µ ì—†ìœ¼ë©´ ê´€ë ¨ Pod ì œê±° |
| **Replication Controller** / **ReplicaSet Controller** | ì›í•˜ëŠ” ìˆ˜ì˜ Podë¥¼ í•­ìƒ ìœ ì§€ |
| **Deployment Controller** | ë²„ì „ ê´€ë¦¬, ë¡¤ë°±, ë¡¤ë§ ì—…ë°ì´íŠ¸ ë“± ì§€ì› |
| **Namespace Controller** | ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì™€ ê´€ë ¨ ë¦¬ì†ŒìŠ¤ ê´€ë¦¬ |
| **PersistentVolume Controller** | PV/PVC ë°”ì¸ë”© ë° ìƒíƒœ ê°ì‹œ |

## ğŸ” ì‘ë™ íë¦„ ì˜ˆì‹œ (NodeController ê¸°ì¤€)

1. 5ì´ˆë§ˆë‹¤ ê° ë…¸ë“œì˜ ìƒíƒœë¥¼ ì²´í¬ (Heartbeat)
2. ì‘ë‹µ ì—†ìœ¼ë©´ ì¼ì • ì‹œê°„ í›„ `NotReady`ë¡œ í‘œì‹œ
3. 5ë¶„ ì´ìƒ ì‘ë‹µ ì—†ìœ¼ë©´ í•´ë‹¹ ë…¸ë“œì˜ Pod ê°•ì œ ì œê±°
4. ReplicaSet/Deploymentê°€ ë‹¤ì‹œ ìŠ¤ì¼€ì¤„ë§í•˜ì—¬ ë‹¤ë¥¸ ë…¸ë“œì— Pod ìƒì„±

## âš™ï¸ êµ¬ì„± ë° ì„¤ì¹˜ ìœ„ì¹˜

### kubeadmìœ¼ë¡œ ì„¤ì¹˜í•œ ê²½ìš°:

- `kube-controller-manager`ëŠ” **Static Pod**ë¡œ ì‹¤í–‰ë¨
- YAML ìœ„ì¹˜:

    ```
    
    /etc/kubernetes/manifests/kube-controller-manager.yaml
    
    ```


### ìˆ˜ë™ ì„¤ì¹˜í•œ ê²½ìš°:

- ì‹œìŠ¤í…œ ì„œë¹„ìŠ¤ë¡œ ì‹¤í–‰ë¨
- í™•ì¸ ìœ„ì¹˜ ì˜ˆì‹œ:

    ```
    
    /etc/systemd/system/kube-controller-manager.service
    
    ```


## ğŸ”§ ì£¼ìš” ì‹¤í–‰ ì˜µì…˜

| ì˜µì…˜ | ì„¤ëª… |
| --- | --- |
| `--controllers=*` | ì‹¤í–‰í•  ì»¨íŠ¸ë¡¤ëŸ¬ ì¢…ë¥˜ (ê¸°ë³¸: ì „ë¶€ ì‹¤í–‰) |
| `--node-monitor-period` | ë…¸ë“œ ìƒíƒœ ì ê²€ ì£¼ê¸° |
| `--pod-eviction-timeout` | ë…¸ë“œ ì‘ë‹µ ì—†ì„ ì‹œ Pod ì œê±°ê¹Œì§€ ëŒ€ê¸° ì‹œê°„ |
| `--leader-elect=true` | ê³ ê°€ìš©ì„±ì„ ìœ„í•œ ë¦¬ë” ì„ ì¶œ ê¸°ëŠ¥ í™œì„±í™” |

> kube-controller-managerëŠ” â€œì»¨íŠ¸ë¡¤ íƒ€ì›Œâ€
>
>
> ê° ì»¨íŠ¸ë¡¤ëŸ¬ëŠ” ë¶€ì„œ(ë…¸ë“œ ê´€ë¦¬, ë°°í¬ ê´€ë¦¬ ë“±)
>
> í´ëŸ¬ìŠ¤í„° ìƒíƒœë¥¼ ë³´ê³  ê³„ì†í•´ì„œ â€œìë™ ì¡°ì •â€í•¨
>

---

## Kube Scheduler í•µì‹¬ ì •ë¦¬

### ì—­í• 

- **Kube Scheduler**ëŠ” **Podê°€ ì–´ëŠ Nodeì— ë°°ì¹˜ë ì§€ ê²°ì •**í•˜ëŠ” ì»´í¬ë„ŒíŠ¸.
- ì‹¤ì œë¡œ Podë¥¼ Nodeì— ë°°ì¹˜í•˜ëŠ” ê²ƒì€ **kubelet**ì˜ ì—­í• .
- ë§ˆìŠ¤í„° ë…¸ë“œì—ì„œ ì‹¤í–‰ë˜ë©°, `kube-system` ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì˜ Podë¡œ ì¡´ì¬.

### ìŠ¤ì¼€ì¤„ë§ ë™ì‘ ë°©ì‹

1. **Filter ë‹¨ê³„**
    - ë¦¬ì†ŒìŠ¤ ë¶€ì¡±(CPU, Memory ë“±), taint/toleration, nodeSelector ë“± ì¡°ê±´ì— **ë§ì§€ ì•ŠëŠ” Nodeë¥¼ ì œê±°**.
2. **Score(ìš°ì„ ìˆœìœ„) ë‹¨ê³„**
    - ë‚¨ì€ Nodeì— ì ìˆ˜(0~10)ë¥¼ ë§¤ê²¨ **ê°€ì¥ ì í•©í•œ Nodeë¥¼ ì„ íƒ**.
    - ì˜ˆ: Podë¥¼ ë°°ì¹˜í•˜ê³  ë‚¨ëŠ” ìì›ì´ ë§ì€ Nodeì— ë†’ì€ ì ìˆ˜ ë¶€ì—¬.
3. **ìµœì¢… ì„ ì •**
    - ì ìˆ˜ê°€ ê°€ì¥ ë†’ì€ Nodeì— Pod ìŠ¤ì¼€ì¤„ë§.

### ğŸ”§ ì„¤ì¹˜ ë° êµ¬ì„±

- `kubeadm`ìœ¼ë¡œ ì„¤ì¹˜ ì‹œ:
    - `kube-scheduler`ëŠ” `/etc/kubernetes/manifests/kube-scheduler.yaml`ì— ì •ì˜ëœ **Static Pod** í˜•íƒœë¡œ ë°°í¬ë¨.
    - ê´€ë ¨ ì„¤ì •ì€ í•´ë‹¹ YAML íŒŒì¼ì—ì„œ í™•ì¸ ê°€ëŠ¥.
- ìˆ˜ë™ ì„¤ì¹˜ ì‹œ:
    - Kubernetes ë¦´ë¦¬ìŠ¤ í˜ì´ì§€ì—ì„œ `kube-scheduler` ë°”ì´ë„ˆë¦¬ ë‹¤ìš´ë¡œë“œ.
    - ìŠ¤ì¼€ì¤„ëŸ¬ êµ¬ì„± íŒŒì¼ ì§€ì •í•˜ì—¬ ì‹¤í–‰.

### âš™ï¸ ì£¼ìš” ì„¤ì • í•­ëª©

- `-config`: ì‚¬ìš©ì ì •ì˜ ìŠ¤ì¼€ì¤„ëŸ¬ ì •ì±… íŒŒì¼ ì§€ì •
- ë‹¤ì–‘í•œ ìŠ¤ì¼€ì¤„ë§ ì •ì±… ì˜ˆì‹œ:
    - nodeAffinity / podAffinity
    - taints and tolerations
    - topology spread constrain

---

## Kubelet í•µì‹¬ ì •ë¦¬

### ì—­í• 

- Kubeletì€ **ë…¸ë“œì—ì„œ ì‹¤í–‰ë˜ëŠ” ì—ì´ì „íŠ¸**.
- **Podì˜ ìƒì„±, ì‹¤í–‰, ëª¨ë‹ˆí„°ë§ì„ ì±…ì„**ì§€ëŠ” í•µì‹¬ ì»´í¬ë„ŒíŠ¸.
- **Kube Scheduler**ê°€ ê²°ì •í•œ ë…¸ë“œì— ì‹¤ì œë¡œ Podë¥¼ ë°°ì¹˜í•¨ (ì»¨í…Œì´ë„ˆ ëŸ°íƒ€ì„ ì‚¬ìš©).
- ì£¼ê¸°ì ìœ¼ë¡œ **Pod ìƒíƒœë¥¼ API ì„œë²„ì— ë³´ê³ **í•¨.

### ê¸°ëŠ¥ ìš”ì•½

- **PodSpec ìˆ˜ì‹ ** â†’ í•´ë‹¹ ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ í’€ë§ ë° ì‹¤í–‰
- **ì»¨í…Œì´ë„ˆ ëŸ°íƒ€ì„** í˜¸ì¶œ (ì˜ˆ: Docker, containerd)
- **ìƒíƒœ ë³´ê³ **: Pod ìƒíƒœë¥¼ API Serverì— ì£¼ê¸°ì ìœ¼ë¡œ ì „ë‹¬
- **í—¬ìŠ¤ ì²´í¬ ìˆ˜í–‰**: liveness/readiness probes ì‹¤í–‰

### ì„¤ì¹˜ ë° ì‹¤í–‰

- `kubeadm` ì‚¬ìš© ì‹œ ìë™ ì„¤ì¹˜ë˜ì§€ ì•ŠìŒ
- **ì‘ì—…ì ë…¸ë“œì— ìˆ˜ë™ ì„¤ì¹˜ í•„ìš”**
    - Kubelet ë°”ì´ë„ˆë¦¬ ì„¤ì¹˜ í›„ ì„œë¹„ìŠ¤ë¡œ ë“±ë¡
- ì‹¤í–‰ í™•ì¸: `ps aux | grep kubelet` ë˜ëŠ” `systemctl status kubelet`

### ê´€ë ¨ íŒŒì¼/ì˜µì…˜

- ì£¼ìš” êµ¬ì„± íŒŒì¼:
    - `/etc/systemd/system/kubelet.service.d/10-kubeadm.conf`
    - `/var/lib/kubelet/config.yaml`
- ì‹¤í–‰ ì‹œ ì£¼ìš” ì˜µì…˜:
    - `-config`: Kubelet ì„¤ì • íŒŒì¼ ì§€ì •
    - `-kubeconfig`: API Server ì ‘ê·¼ìš© ì¸ì¦ì •ë³´ ê²½ë¡œ
    - `-container-runtime`: ì‚¬ìš©í•  ì»¨í…Œì´ë„ˆ ëŸ°íƒ€ì„ ì§€ì •

---

## Kube-Proxy í•µì‹¬ ì •ë¦¬

### ì—­í• 

- **ì„œë¹„ìŠ¤ íŠ¸ë˜í”½ì„ í•´ë‹¹ ë°±ì—”ë“œ Podë¡œ ì „ë‹¬**í•˜ëŠ” ì—­í• 
- ê° ë…¸ë“œì—ì„œ ì‹¤í–‰ë˜ë©° **í´ëŸ¬ìŠ¤í„° ë‚´ í†µì‹ ì„ ë¼ìš°íŒ…**í•¨
- ê°€ìƒ IP(ClusterIP)ë¥¼ ì‹¤ì œ Pod IPë¡œ ì—°ê²°í•´ì£¼ëŠ” ë¸Œë¦¬ì§€ ì—­í• 

### ë™ì‘ ì›ë¦¬

| ê¸°ëŠ¥ | ì„¤ëª… |
| --- | --- |
| ì„œë¹„ìŠ¤ ë°œê²¬ | ì„œë¹„ìŠ¤ê°€ ìƒì„±ë˜ë©´ Kube-ProxyëŠ” ì´ë¥¼ ê°ì§€ |
| ë¼ìš°íŒ… ê·œì¹™ ì„¤ì • | ê° ë…¸ë“œì— `iptables` ë˜ëŠ” `IPVS` ê·œì¹™ì„ ì„¤ì • |
| íŠ¸ë˜í”½ ì „ë‹¬ | í´ëŸ¬ìŠ¤í„° IPë¡œ ë„ë‹¬í•œ íŠ¸ë˜í”½ì„ ì ì ˆí•œ ë°±ì—”ë“œ Podë¡œ ì „ë‹¬ |
| ê°€ìƒ ì»´í¬ë„ŒíŠ¸ ì—°ê²° | ì„œë¹„ìŠ¤ëŠ” ë¬¼ë¦¬ì  ê°ì²´ê°€ ì•„ë‹ˆë¯€ë¡œ, íŠ¸ë˜í”½ì€ ë°˜ë“œì‹œ Kube-Proxyë¥¼ í†µí•´ ë°±ì—”ë“œ Podë¡œ ì „ì†¡ë¨ |

### Kube-Proxy ë™ì‘ ì˜ˆì‹œ

- ì›¹ ì•±ì´ DB ì„œë¹„ìŠ¤ë¥¼ í˜¸ì¶œí•  ë•Œ `db-service`ë¼ëŠ” ì´ë¦„ì´ë‚˜ ClusterIPë¥¼ ì‚¬ìš©
- **Kube-ProxyëŠ” ì´ ìš”ì²­ì„ í¬ì›Œë”©í•˜ì—¬ DB Podì— ì—°ê²°**
- ë‚´ë¶€ì ìœ¼ë¡œëŠ” iptables ê·œì¹™ì´ë‚˜ `ipvsadm`ì„ ì‚¬ìš©í•˜ì—¬ ì—°ê²°

### ì„¤ì¹˜ ë°©ì‹

| ë„êµ¬ | ì„¤ëª… |
| --- | --- |
| kubeadm | `kube-proxy`ë¥¼ **DaemonSet** í˜•íƒœë¡œ ë°°í¬í•¨ (ê° ë…¸ë“œ 1ê°œ Pod) |
| ìˆ˜ë™ ì„¤ì¹˜ | Kubernetes ê³µì‹ ë°”ì´ë„ˆë¦¬ ë‹¤ìš´ë¡œë“œ â†’ systemd ì„œë¹„ìŠ¤ë¡œ ì‹¤í–‰ ê°€ëŠ¥ |
- ì„¤ì¹˜ í›„ í™•ì¸: `kubectl get pods -n kube-system -o wide | grep kube-proxy`
- ì‹¤í–‰ êµ¬ì¡°: `DaemonSet` â†’ ëª¨ë“  ë…¸ë“œì— ìë™ ë°°ì¹˜

---

## Pods í•µì‹¬ ìš”ì•½

### 1. **Podë€ ë¬´ì—‡ì¸ê°€**

- Kubernetesì—ì„œ **ê°€ì¥ ì‘ì€ ë°°í¬ ë‹¨ìœ„**ì´ë‹¤.
- í•˜ë‚˜ì˜ PodëŠ” **í•˜ë‚˜ ì´ìƒì˜ ì»¨í…Œì´ë„ˆ**ë¥¼ í¬í•¨í•  ìˆ˜ ìˆìŒ.
- ëŒ€ë¶€ë¶„ì˜ ê²½ìš° **ì»¨í…Œì´ë„ˆ 1ê°œ â†” Pod 1ê°œ** êµ¬ì¡° ì‚¬ìš©.
- ì»¨í…Œì´ë„ˆëŠ” Pod ì•ˆì—ì„œ **ë„¤íŠ¸ì›Œí¬, ìŠ¤í† ë¦¬ì§€ ê³µê°„ì„ ê³µìœ **í•œë‹¤.
- PodëŠ” **ê°™ì´ ìƒì„±ë˜ê³ , ê°™ì´ ì‚¬ë¼ì§€ëŠ”** ë‹¨ìœ„ì´ë‹¤.

### 2. **Podì˜ ì—­í•  ë° êµ¬ì¡°**

- ì‚¬ìš©ì ìš”ì²­ì´ ì¦ê°€í•˜ë©´ **Pod ìˆ˜ë¥¼ ëŠ˜ë ¤ì„œ(scale-out)** ëŒ€ì‘í•œë‹¤.
    - ê°™ì€ Pod ë‚´ì— ì»¨í…Œì´ë„ˆë¥¼ ì¶”ê°€í•˜ì§€ ì•Šê³ , **ìƒˆë¡œìš´ Pod**ë¥¼ ìƒì„±í•¨.
- PodëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ **ë‹¨ì¼ ì¸ìŠ¤í„´ìŠ¤**ë¥¼ ë‚˜íƒ€ë‚¸ë‹¤.
- ì»¨í…Œì´ë„ˆ ê°„ í†µì‹ , ìŠ¤í† ë¦¬ì§€ ê³µìœ  ë“±ì€ Pod ë‚´ë¶€ì—ì„œ ì²˜ë¦¬ë¨.

### 3. **ë‹¤ì¤‘ ì»¨í…Œì´ë„ˆ Pod ì‚¬ìš© ì‚¬ë¡€**

- ì¼ë°˜ì ì´ì§€ ì•Šì§€ë§Œ, íŠ¹ì • ìƒí™©ì—ì„œëŠ” ìœ ìš©:
    - ex) **ì›¹ ì„œë²„ + íŒŒì¼ ì²˜ë¦¬ ë„ìš°ë¯¸** ì»¨í…Œì´ë„ˆë¥¼ ê°™ì€ Podì— ë°°ì¹˜
- ë‹¤ì¤‘ ì»¨í…Œì´ë„ˆëŠ”:
    - **ë¡œì»¬ í˜¸ìŠ¤íŠ¸ ë„¤íŠ¸ì›Œí¬ë¡œ ì§ì ‘ í†µì‹ **
    - **ë³¼ë¥¨ ê³µìœ ** ê°€ëŠ¥
    - ìƒëª…ì£¼ê¸°ë¥¼ í•¨ê»˜í•¨

### 4. **Docker ë‹¨ë… vs Kubernetes Pod**

| í•­ëª© | Docker ë‹¨ë… | Kubernetes Pod |
| --- | --- | --- |
| ìŠ¤ì¼€ì¼ë§ | ì§ì ‘ ëª…ë ¹ì–´ë¡œ ì—¬ëŸ¬ ì»¨í…Œì´ë„ˆ ìƒì„± | Pod ìˆ˜ ìë™ í™•ì¥ |
| ë„¤íŠ¸ì›Œí¬ ì—°ê²° | ìˆ˜ë™ êµ¬ì„± í•„ìš” | ë™ì¼ Pod ë‚´ ìë™ ì—°ê²° |
| ë³¼ë¥¨ ê³µìœ  | ìˆ˜ë™ ì„¤ì • | ìë™ ê³µìœ  ê°€ëŠ¥ |
| ìƒíƒœ ê´€ë¦¬ | ìˆ˜ë™ ëª¨ë‹ˆí„°ë§ ë° ì¢…ë£Œ | í•¨ê»˜ ì‹œì‘/ì¢…ë£Œë¨ |

### 5. **Pod ìƒì„± ë°©ë²•**

- `kubectl run` ëª…ë ¹ ì‚¬ìš©

  ì˜ˆì‹œ: `kubectl run nginx --image=nginx`

- ê¸°ë³¸ì ìœ¼ë¡œ `Docker Hub`ì—ì„œ ì´ë¯¸ì§€ë¥¼ ê°€ì ¸ì˜´
- Pod ëª©ë¡ í™•ì¸: `kubectl get pods`

### 6. **ê¸°ë³¸ ìš´ì˜ ë°©ì‹**

- ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ëŠ” **Docker Hub ë˜ëŠ” ì‚¬ì„¤ ë ˆì§€ìŠ¤íŠ¸ë¦¬**ì—ì„œ Pullí•¨.
- PodëŠ” ìƒì„± ì§í›„ ìƒíƒœê°€ `ContainerCreating` â†’ `Running`ìœ¼ë¡œ ë³€ê²½ë¨.
- ìƒì„±ëœ PodëŠ” **ë‚´ë¶€ì—ì„œëŠ” ì ‘ê·¼ ê°€ëŠ¥**í•˜ë‚˜, ì™¸ë¶€ ì ‘ê·¼ì„ ìœ„í•´ì„  **Service ë¦¬ì†ŒìŠ¤ ì„¤ì •** í•„ìš”.

---

## YAMLì„ ì´ìš©í•œ Pod ìƒì„±

### 1. Kubernetes YAML ì •ì˜ íŒŒì¼ì˜ ê¸°ë³¸ êµ¬ì¡°

ëª¨ë“  ì¿ ë²„ë„¤í‹°ìŠ¤ ë¦¬ì†ŒìŠ¤(YAML ì •ì˜)ëŠ” ë‹¤ìŒ 4ê°œì˜ **ë£¨íŠ¸ í•„ë“œ**ë¡œ êµ¬ì„±ëœë‹¤:

| í•„ë“œëª… | ì„¤ëª… |
| --- | --- |
| `apiVersion` | ë¦¬ì†ŒìŠ¤ë¥¼ ìƒì„±í•  ë•Œ ì‚¬ìš©í•  Kubernetes APIì˜ ë²„ì „ (ì˜ˆ: `v1`, `apps/v1`) |
| `kind` | ìƒì„±í•  ë¦¬ì†ŒìŠ¤ì˜ ì¢…ë¥˜ (ì˜ˆ: `Pod`, `Deployment`, `Service`) |
| `metadata` | ë¦¬ì†ŒìŠ¤ì˜ ë©”íƒ€ ì •ë³´ (ì´ë¦„, ë¼ë²¨ ë“±) |
| `spec` | ë¦¬ì†ŒìŠ¤ì˜ êµ¬ì²´ì ì¸ ì‚¬ì–‘ (ì»¨í…Œì´ë„ˆ ì •ë³´ ë“±) |

### 2. ê° í•„ë“œì˜ ìƒì„¸ ì„¤ëª…

### `apiVersion`

- ìƒì„±í•  ë¦¬ì†ŒìŠ¤ì— ë”°ë¼ ë‹¤ë¦„
- ì˜ˆì‹œ:
    - `Pod` â†’ `v1`
    - `Deployment` â†’ `apps/v1`

### `kind`

- ìƒì„±í•  ë¦¬ì†ŒìŠ¤ íƒ€ì… ëª…ì‹œ
    - ì˜ˆ: `Pod`, `Service`, `Deployment`, `ReplicaSet` ë“±

### `metadata`

- `name`: ê°ì²´ ì´ë¦„ (ì˜ˆ: `my-app-pod`)
- `labels`: key-value í˜•ì‹ì˜ íƒœê·¸ë¡œ ë¶„ë¥˜ ë° ì„ íƒì— í™œìš©

```yaml

metadata:
  name: my-app-pod
  labels:
    app: myapp
    tier: frontend

```

### `spec`

- ë¦¬ì†ŒìŠ¤ì˜ ë™ì‘ ì •ì˜
- `Pod`ì—ì„œëŠ” ì£¼ë¡œ ë‹¤ìŒê³¼ ê°™ì€ êµ¬ì„± ì‚¬ìš©:

```yaml

spec:
  containers:
    - name: nginx-container
      image: nginx

```

> containersëŠ” ë¦¬ìŠ¤íŠ¸ í˜•ì‹ì´ë©°, ì—¬ëŸ¬ ê°œì˜ ì»¨í…Œì´ë„ˆë„ í¬í•¨ ê°€ëŠ¥
>

### 3. Pod YAML ì •ì˜ ì˜ˆì‹œ

```yaml

apiVersion: v1
kind: Pod
metadata:
  name: my-app-pod
  labels:
    app: myapp
spec:
  containers:
    - name: nginx-container
      image: nginx

```

### 4. YAML ì ìš© ë° í™•ì¸

- YAMLë¡œ ë¦¬ì†ŒìŠ¤ë¥¼ ìƒì„±:

```bash

kubectl apply -f pod-definition.yaml

```

- ìƒì„±ëœ Pod í™•ì¸:

```bash

kubectl get pods

```

- Pod ìƒì„¸ ì •ë³´ í™•ì¸:

```bash

kubectl describe pod my-app-pod

```

### 5. YAML ì‘ì„± ì‹œ ì£¼ì˜í•  ì 

- **ë“¤ì—¬ì“°ê¸°** ì¤‘ìš”: YAMLì€ ë“¤ì—¬ì“°ê¸°ê°€ ë¬¸ë²•ì´ë‹¤
- `metadata` ì•„ë˜ì˜ `name`, `labels`ëŠ” **ê°™ì€ depth**
- `containers`ëŠ” **ë¦¬ìŠ¤íŠ¸(-)** í˜•ì‹ì´ë©°, ê° í•­ëª©ì€ `name`, `image` ë“±ì˜ í•˜ìœ„ ì†ì„± í¬í•¨

---

### 1. **ì¿ ë²„ë„¤í‹°ìŠ¤ ì»¨íŠ¸ë¡¤ëŸ¬ë€?**

- ì¿ ë²„ë„¤í‹°ìŠ¤ì˜ â€œë‘ë‡Œâ€ ì—­í• 
- í´ëŸ¬ìŠ¤í„° ìƒíƒœë¥¼ ì§€ì†ì ìœ¼ë¡œ **ëª¨ë‹ˆí„°ë§í•˜ê³ **, ì„¤ì •ëœ **ì›í•˜ëŠ” ìƒíƒœ(desired state)**ì— ë§ê²Œ ì¡°ì •í•¨

### 2. **Replication Controller (RC):**

### ê°œë…

- ì§€ì •ëœ ìˆ˜ì˜ **í¬ë“œ(Pod)** ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìœ ì§€í•˜ëŠ” ì—­í• 
- ì•±ì´ ì£½ê±°ë‚˜ ê³ ì¥ ë‚˜ë©´ ìë™ìœ¼ë¡œ ìƒˆ í¬ë“œë¥¼ ìƒì„±í•˜ì—¬ **ê³ ê°€ìš©ì„±** ë³´ì¥

### ì‚¬ìš© ì˜ˆì‹œ

- í¬ë“œ í•˜ë‚˜ê°€ ì£½ìœ¼ë©´ ìƒˆë¡œìš´ í¬ë“œë¥¼ ìƒì„±í•˜ì—¬ ê³„ì† ì‹¤í–‰
- ì—¬ëŸ¬ í¬ë“œë¥¼ ì‹¤í–‰í•´ **ë¡œë“œ ë°¸ëŸ°ì‹±(ë¶€í•˜ ë¶„ì‚°)** ê°€ëŠ¥

### ì •ì˜ íŒŒì¼ êµ¬ì¡° (RC-definition.yaml)

- êµ¬ì„± ìš”ì†Œ: `apiVersion`, `kind`, `metadata`, `spec`
- spec ì•ˆì—:
    - `replicas`: ëª‡ ê°œì˜ í¬ë“œë¥¼ ìœ ì§€í• ì§€
    - `template`: ì–´ë–¤ í¬ë“œë¥¼ ë§Œë“¤ì§€ ì •ì˜ (í¬ë“œ ì •ì˜ ì¤‘ì²©)

### ëª…ë ¹ì–´

- ìƒì„±: `kubectl create -f RC-definition.yaml`
- ì¡°íšŒ: `kubectl get rc`, `kubectl get pods`

### 3. **ReplicaSet (RS):**

### ê°œë…

- RCì˜ **ì—…ê·¸ë ˆì´ë“œ ë²„ì „**
- ë” ë§ì€ **ì„ íƒê¸° ê¸°ëŠ¥**ê³¼ **ìœ ì—°ì„±** ì œê³µ
- í˜„ì¬ëŠ” RCë³´ë‹¤ RS ì‚¬ìš©ì´ **ê¶Œì¥ë¨**

### êµ¬ì¡°ìƒì˜ ì°¨ì´ì 

- `apiVersion`ì´ `apps/v1`
- **selector** í•„ë“œê°€ **í•„ìˆ˜**
    - ì–´ë–¤ ë¼ë²¨ì„ ê°€ì§„ í¬ë“œë¥¼ ê´€ë¦¬í• ì§€ ëª…ì‹œ
- ì´ì „ì— ë§Œë“¤ì–´ë‘” í¬ë“œë„ ë ˆì´ë¸”ì´ ì¼ì¹˜í•˜ë©´ í¬í•¨ ê°€ëŠ¥
- RCì™€ êµ¬ì¡°ëŠ” ë¹„ìŠ·í•˜ë˜, selectorì™€ label ë§¤ì¹­ì´ ì¤‘ìš”

### ìŠ¤ì¼€ì¼ë§ ë°©ë²•

1. ì •ì˜ íŒŒì¼ ìˆ˜ì • í›„ `kubectl replace -f <íŒŒì¼ëª…>`
2. `kubectl scale --replicas=6 -f <íŒŒì¼ëª…>` ë˜ëŠ” `-replicas=6 replicaset/<ì´ë¦„>`

### ëª…ë ¹ì–´ ìš”ì•½

- ìƒì„±: `kubectl create -f RS-definition.yaml`
- ì¡°íšŒ: `kubectl get rs`, `kubectl get pods`
- ì‚­ì œ: `kubectl delete rs <ì´ë¦„>`
- ì—…ë°ì´íŠ¸: `kubectl replace -f <íŒŒì¼ëª…>`
- ìŠ¤ì¼€ì¼ ì¡°ì •: `kubectl scale --replicas=6 -f <íŒŒì¼ëª…>`

### 4. **ë¼ë²¨ê³¼ ì„ íƒê¸°ì˜ ì¤‘ìš”ì„±**

- ì¿ ë²„ë„¤í‹°ìŠ¤ëŠ” **ë¼ë²¨(label)**ì„ ê¸°ë°˜ìœ¼ë¡œ í¬ë“œë¥¼ ì‹ë³„í•˜ê³  ê·¸ë£¹í™”í•¨
- ReplicaSetì€ ì´ ë¼ë²¨ì„ í†µí•´ **ì–´ë–¤ í¬ë“œë¥¼ ê´€ë¦¬í• ì§€ íŒë‹¨**
- ë”°ë¼ì„œ `spec.selector.matchLabels`ì™€ `template.metadata.labels`ëŠ” ì¼ì¹˜í•´ì•¼ í•¨

## ìš”ì•½

| í•­ëª© | ë‚´ìš© |
| --- | --- |
| ë¬¸ì œ | ë‹¨ì¼ í¬ë“œëŠ” ì¥ì•  ì‹œ ì•± ì¤‘ë‹¨ ìœ„í—˜ |
| í•´ê²° | RC ë˜ëŠ” RSë¥¼ ì‚¬ìš©í•´ ë³µì œë³¸ ìœ ì§€ |
| í•µì‹¬ ê¸°ëŠ¥ | í¬ë“œ ìë™ ìƒì„±, ë¡œë“œ ë¶„ì‚°, ì¥ì•  ëŒ€ì‘ |
| RS vs RC | RSê°€ ë” í˜„ëŒ€ì ì´ë©° selector ë“± í™•ì¥ì„± ì œê³µ |
| í•µì‹¬ êµ¬ì¡° | ì •ì˜ íŒŒì¼ ë‚´ `spec.replicas`, `spec.template`, `spec.selector` |
| ê´€ë ¨ ëª…ë ¹ì–´ | `kubectl create/get/delete/replace/scale` |

---

# Deployment

## Deploymentë€?

> DeploymentëŠ” Kubernetesì—ì„œ ì• í”Œë¦¬ì¼€ì´ì…˜ ë°°í¬, ì—…ê·¸ë ˆì´ë“œ, ë¡¤ë°±, ìŠ¤ì¼€ì¼ë§ ë“±ì„ ìë™ìœ¼ë¡œ ê´€ë¦¬í•˜ëŠ” ìƒìœ„ ê°œë… ë¦¬ì†ŒìŠ¤ì´ë‹¤.
>

### ì£¼ìš” ê¸°ëŠ¥

| ê¸°ëŠ¥ | ì„¤ëª… |
| --- | --- |
| **ìŠ¤ì¼€ì¼ë§** | ì—¬ëŸ¬ ê°œì˜ Pod ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±í•´ ê³ ê°€ìš©ì„± ë³´ì¥ |
| **ë¡¤ë§ ì—…ë°ì´íŠ¸** | Podë¥¼ ìˆœì°¨ì ìœ¼ë¡œ ì—…ë°ì´íŠ¸í•˜ì—¬ ë‹¤ìš´íƒ€ì„ ì—†ì´ ë²„ì „ ë³€ê²½ ê°€ëŠ¥ |
| **ë¡¤ë°±** | ë¬¸ì œê°€ ìƒê¸°ë©´ ì´ì „ ë²„ì „ìœ¼ë¡œ ì†ì‰½ê²Œ ë˜ëŒë¦´ ìˆ˜ ìˆìŒ |
| **ì¼ì‹œ ì¤‘ì§€/ì¬ê°œ** | ì¼ì‹œì ìœ¼ë¡œ ë³€ê²½ ì ìš©ì„ ë©ˆì·„ë‹¤ê°€, ë‚˜ì¤‘ì— ë‹¤ì‹œ ì‹¤í–‰ ê°€ëŠ¥ |

## ì™œ Deploymentë¥¼ ì‚¬ìš©í•˜ëŠ”ê°€?

| ìƒí™© | Deploymentë¡œ í•´ê²° ê°€ëŠ¥ |
| --- | --- |
| ì›¹ ì„œë²„ë¥¼ ì—¬ëŸ¬ ê°œ ë„ì›Œì•¼ í•  ë•Œ | ReplicaSetì„ ìë™ ìƒì„±í•˜ì—¬ ë‹¤ì¤‘ ì¸ìŠ¤í„´ìŠ¤ ê´€ë¦¬ |
| ìƒˆ ë²„ì „ìœ¼ë¡œ ì ì§„ì  ì—…ë°ì´íŠ¸ | ë¡¤ë§ ì—…ë°ì´íŠ¸ ê¸°ëŠ¥ ì œê³µ |
| ì˜¤ë¥˜ ë°œìƒ ì‹œ ì´ì „ ìƒíƒœë¡œ ë³µê·€ | ì†ì‰¬ìš´ Rollback ê¸°ëŠ¥ |
| ì—¬ëŸ¬ ì„¤ì • ë³€ê²½ì„ í•œ ë²ˆì— ì ìš© | Pause â†’ ìˆ˜ì • â†’ Resume ë°©ì‹ ì§€ì› |

## Deploymentì˜ êµ¬ì¡°

Deployment YAML íŒŒì¼ì€ ë‹¤ìŒê³¼ ê°™ì€ êµ¬ì¡°ë¡œ êµ¬ì„±ëœë‹¤:

```yaml

apiVersion: apps/v1
kind: Deployment
metadata:
  name: web-app-deployment
  labels:
    app: web-app
spec:
  replicas: 3
  selector:
    matchLabels:
      app: web-app
  template:
    metadata:
      labels:
        app: web-app
    spec:
      containers:
        - name: nginx
          image: nginx:1.25

```

### ì£¼ìš” í•„ë“œ ì„¤ëª…:

- `replicas`: ì›í•˜ëŠ” Podì˜ ê°œìˆ˜
- `selector`: ì–´ë–¤ ë¼ë²¨ì„ ê°€ì§„ Podë¥¼ ê´€ë¦¬í• ì§€ ì§€ì •
- `template`: ì‹¤ì œë¡œ ë°°í¬í•  Podì˜ í…œí”Œë¦¿ (spec í¬í•¨)
- `containers`: ì»¨í…Œì´ë„ˆ ëª©ë¡ê³¼ ì´ë¯¸ì§€

DeploymentëŠ” ë‚´ë¶€ì ìœ¼ë¡œ ReplicaSetì„ ìë™ ìƒì„±í•˜ë©°, ReplicaSetì€ ë‹¤ì‹œ Podë¥¼ ìƒì„±í•¨

## Deployment ìƒì„± ë° í™•ì¸ ëª…ë ¹ì–´

```bash

# ë°°í¬ ìƒì„±
kubectl apply -f deployment.yaml

# ìƒì„±ëœ ë°°í¬ ë¦¬ì†ŒìŠ¤ í™•ì¸
kubectl get deployments

# ìƒì„±ëœ ReplicaSet í™•ì¸
kubectl get rs

# ìƒì„±ëœ Pod í™•ì¸
kubectl get pods

```

## Deploymentê°€ ê´€ë¦¬í•˜ëŠ” ì „ì²´ êµ¬ì¡°

```

Deployment
  â””â”€â”€ ReplicaSet (ìë™ ìƒì„±)
        â””â”€â”€ Pod (ë³µìˆ˜ ê°œ)

```

## ìš”ì•½ ì •ë¦¬

- DeploymentëŠ” **ì‹¤ì œ ìš´ì˜ í™˜ê²½ì—ì„œ ì•±ì„ ì•ˆì •ì ìœ¼ë¡œ ë°°í¬**í•˜ëŠ” í•µì‹¬ ë„êµ¬
- ReplicaSetê³¼ Podì„ **ìë™ìœ¼ë¡œ ìƒì„±í•˜ê³  ì œì–´**
- ë¡¤ë§ ì—…ë°ì´íŠ¸, ë¡¤ë°±, ìŠ¤ì¼€ì¼ë§, ì¼ì‹œì •ì§€/ì¬ê°œ ë“±ì˜ ê³ ê¸‰ ê¸°ëŠ¥ ì œê³µ
- YAML êµ¬ì¡°ëŠ” ReplicaSetê³¼ ìœ ì‚¬í•˜ì§€ë§Œ ìƒìœ„ ê°œë…

---

# ì„œë¹„ìŠ¤

- **PodëŠ” ì¼ì‹œì ì¸ ì¡´ì¬**ë¼ì„œ IPê°€ ê³„ì† ë°”ë€œ â†’ **ì•ˆì •ì ì¸ ì ‘ê·¼**ì„ ë³´ì¥í•˜ê¸° ìœ„í•´ **Service ê°ì²´ê°€ í•„ìš”**í•¨.
- **ServiceëŠ” ë…¼ë¦¬ì  Pod ê·¸ë£¹ì— ê³ ì • IP/ë„ë©”ì¸ì„ ë¶€ì—¬**í•˜ê³ , ë¡œë“œë°¸ëŸ°ì‹±ê¹Œì§€ ë‹´ë‹¹í•¨.

### ì£¼ìš” ì„œë¹„ìŠ¤ ìœ í˜•

| ì„œë¹„ìŠ¤ ìœ í˜• | ì„¤ëª… |
| --- | --- |
| **ClusterIP** | ê¸°ë³¸ê°’. í´ëŸ¬ìŠ¤í„° ë‚´ë¶€ì—ì„œë§Œ ì ‘ê·¼ ê°€ëŠ¥. ë‚´ë¶€ í†µì‹ ìš© (ex. frontend â†’ backend) |
| **NodePort** | ë…¸ë“œì˜ íŠ¹ì • í¬íŠ¸ë¥¼ í†µí•´ ì™¸ë¶€ì—ì„œ ì ‘ê·¼ ê°€ëŠ¥. ê°œë°œ/í…ŒìŠ¤íŠ¸ í™˜ê²½ì—ì„œ ì£¼ë¡œ ì‚¬ìš© |
| **LoadBalancer** | í´ë¼ìš°ë“œ í™˜ê²½ì—ì„œ ì™¸ë¶€ ë¡œë“œë°¸ëŸ°ì„œë¥¼ í†µí•´ ì ‘ê·¼. ì„œë¹„ìŠ¤ IPë¥¼ ì™¸ë¶€ì— ë…¸ì¶œ |
| **ExternalName** | DNS ì´ë¦„ì„ ì™¸ë¶€ ì„œë¹„ìŠ¤ë¡œ ë§¤í•‘í•¨ (ë‚´ë¶€ DNS â†’ ì™¸ë¶€ ì„œë¹„ìŠ¤ ì£¼ì†Œ) |

### NodePort ì˜ˆì‹œ ì •ë¦¬

- ì„œë¹„ìŠ¤ êµ¬ì¡°:

    ```
    
    Client â†’ [NodeIP:30008] â†’ Service â†’ Pod(TargetPort:80)
    
    ```

- YAML ì •ì˜:

    ```yaml
    
    apiVersion: v1
    kind: Service
    metadata:
      name: my-service
    spec:
      type: NodePort
      selector:
        app: my-app
      ports:
        - port: 80
          targetPort: 80
          nodePort: 30008
    
    ```

- í•µì‹¬ êµ¬ì„±ìš”ì†Œ:
    - `selector`: ì–´ë–¤ Podë“¤ê³¼ ì—°ê²°í• ì§€ ê²°ì • (`app=my-app`)
    - `targetPort`: ì‹¤ì œ Podì˜ ì»¨í…Œì´ë„ˆê°€ ë¦¬ìŠ¤ë‹ ì¤‘ì¸ í¬íŠ¸
    - `port`: í´ëŸ¬ìŠ¤í„° ë‚´ë¶€ ì„œë¹„ìŠ¤ í¬íŠ¸
    - `nodePort`: ì™¸ë¶€ì—ì„œ ì ‘ê·¼ ê°€ëŠ¥í•œ í¬íŠ¸ (ê¸°ë³¸ ë²”ìœ„ 30000~32767)

### ë™ì‘ íë¦„

1. ì‚¬ìš©ìê°€ `NodeIP:NodePort`ë¡œ ìš”ì²­ì„ ë³´ëƒ„
2. ì¿ ë²„ë„¤í‹°ìŠ¤ê°€ í•´ë‹¹ NodePortë¥¼ ì„œë¹„ìŠ¤ë¡œ ë¼ìš°íŒ…
3. ì„œë¹„ìŠ¤ëŠ” label selectorë¡œ ì¼ì¹˜í•˜ëŠ” Podë¥¼ ì°¾ì•„ ìš”ì²­ ì „ë‹¬
4. Pod ì—¬ëŸ¬ ê°œë¼ë©´ **ìë™ ë¡œë“œë°¸ëŸ°ì‹±(Random ë°©ì‹)** ì ìš©
5. Podê°€ í´ëŸ¬ìŠ¤í„° ë‚´ ì—¬ëŸ¬ ë…¸ë“œì— ë¶„ì‚°ë˜ì–´ ìˆì–´ë„ **ë™ì¼ í¬íŠ¸ ë²ˆí˜¸**ë¡œ ì ‘ê·¼ ê°€ëŠ¥

### íŠ¹ì§•

- ê³ ê°€ìš©ì„±ì„ ìœ„í•´ Podê°€ ì—¬ëŸ¬ ê°œì¼ ê²½ìš°, Serviceê°€ ìë™ìœ¼ë¡œ íŠ¸ë˜í”½ì„ ë¶„ì‚°
- Serviceê°€ ë°”ë¼ë³´ëŠ” Podê°€ ì—†ì–´ì§€ê±°ë‚˜ ìƒˆë¡œ ìƒê²¨ë„ ìë™ìœ¼ë¡œ ì—…ë°ì´íŠ¸ë¨
- ë³„ë„ ì„¤ì • ì—†ì´ **í´ëŸ¬ìŠ¤í„° ì „ì—­ì—ì„œ ë™ì¼í•œ ë°©ì‹ìœ¼ë¡œ ì ‘ê·¼ ê°€ëŠ¥**
- `LoadBalancer`ëŠ” ì‹¤ì„œë¹„ìŠ¤ í´ë¼ìš°ë“œ í™˜ê²½ì—ì„œ ì£¼ë¡œ ì‚¬ìš©

---

# ClusterIPë€?

**ClusterIP**ëŠ” ì¿ ë²„ë„¤í‹°ìŠ¤ì—ì„œ ê°€ì¥ ê¸°ë³¸ì´ ë˜ëŠ” ì„œë¹„ìŠ¤ ìœ í˜•ìœ¼ë¡œ,

**í´ëŸ¬ìŠ¤í„° ë‚´ë¶€ì˜ Pod ê°„ í†µì‹ ì„ ì•ˆì •ì ìœ¼ë¡œ ì—°ê²°**í•´ì£¼ëŠ” ë‚´ë¶€ IP ê¸°ë°˜ì˜ ì„œë¹„ìŠ¤ì…ë‹ˆë‹¤.

## ì™œ ClusterIPê°€ í•„ìš”í•œê°€?

- **PodëŠ” IPê°€ ê³ ì •ë˜ì–´ ìˆì§€ ì•Šë‹¤**: Podê°€ ì¬ì‹œì‘ë˜ê±°ë‚˜ ì¬ë°°í¬ë˜ë©´ IPê°€ ë°”ë€œ
- ë”°ë¼ì„œ **ì§ì ‘ IPë¥¼ ì´ìš©í•´ í†µì‹ í•˜ë©´ ë¶ˆì•ˆì •**í•¨
- ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´, **Serviceë¥¼ í†µí•´ Podë“¤ì„ ë¬¶ê³ , ê³ ì •ëœ ì ‘ê·¼ ì§€ì (IP/ì´ë¦„)ì„ ì œê³µ**í•¨

## ì˜ˆì‹œ: í’€ìŠ¤íƒ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ êµ¬ì¡°

| ê³„ì¸µ | ì—­í•  | Pod ì˜ˆì‹œ | í•„ìš” ì—°ê²° ëŒ€ìƒ |
| --- | --- | --- | --- |
| í”„ë¡ íŠ¸ì—”ë“œ | ì‚¬ìš©ì ìš”ì²­ ì²˜ë¦¬ | `frontend-pod` | `backend` ì„œë¹„ìŠ¤ |
| ë°±ì—”ë“œ | ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì²˜ë¦¬ | `backend-pod` | `redis`, `mysql` ì„œë¹„ìŠ¤ |
| ìºì‹œ | ì„ì‹œ ë°ì´í„° ì €ì¥ | `redis-pod` | - |
| DB | ì˜êµ¬ ë°ì´í„° ì €ì¥ | `mysql-pod` | - |

> ë°±ì—”ë“œëŠ” Redisì™€ MySQLì— ì ‘ê·¼í•´ì•¼ í•˜ê³ , í”„ë¡ íŠ¸ì—”ë“œëŠ” ë°±ì—”ë“œì— ì ‘ê·¼í•´ì•¼ í•¨.
>
>
> ì´ ëª¨ë“  ì—°ê²°ì„ **ClusterIP ì„œë¹„ìŠ¤ë¡œ êµ¬ì„±**í•˜ì—¬ ì•ˆì •ì ì¸ í†µì‹ ì„ ë³´ì¥í•¨.
>

## ClusterIP ì„œë¹„ìŠ¤ ì •ì˜ íŒŒì¼ ì˜ˆì‹œ

```yaml

apiVersion: v1
kind: Service
metadata:
  name: backend
spec:
  selector:
    app: backend
  ports:
    - port: 80         # ì„œë¹„ìŠ¤ê°€ ë…¸ì¶œí•˜ëŠ” í¬íŠ¸
      targetPort: 80   # Pod ë‚´ë¶€ ì»¨í…Œì´ë„ˆê°€ ë¦¬ìŠ¤ë‹í•˜ëŠ” í¬íŠ¸
  type: ClusterIP      # ìƒëµ ê°€ëŠ¥ (ê¸°ë³¸ê°’)

```

- `metadata.name`: ì„œë¹„ìŠ¤ ì´ë¦„ â†’ ë‹¤ë¥¸ Podì—ì„œ `backend`ë¼ëŠ” ì´ë¦„ìœ¼ë¡œ ì ‘ê·¼ ê°€ëŠ¥
- `selector`: í•´ë‹¹ ë¼ë²¨ì„ ê°€ì§„ Podë“¤ì„ ì„ íƒí•´ ì—°ê²°
- `ports.port`: í´ëŸ¬ìŠ¤í„° ë‚´ì—ì„œ ì´ í¬íŠ¸ë¥¼ í†µí•´ ì ‘ê·¼ ê°€ëŠ¥
- `ports.targetPort`: ì‹¤ì œ Pod ë‚´ë¶€ì˜ í¬íŠ¸

## ClusterIPì˜ íŠ¹ì§• ìš”ì•½

| í•­ëª© | ë‚´ìš© |
| --- | --- |
| ê¸°ë³¸ê°’ ì—¬ë¶€ | O (ì„œë¹„ìŠ¤ ìœ í˜•ì„ ì§€ì •í•˜ì§€ ì•Šìœ¼ë©´ ìë™ ClusterIPë¡œ ìƒì„±ë¨) |
| ì ‘ê·¼ ë²”ìœ„ | í´ëŸ¬ìŠ¤í„° ë‚´ë¶€ì—ì„œë§Œ ì ‘ê·¼ ê°€ëŠ¥ |
| ì‚¬ìš© ëª©ì  | **Pod ê°„ í†µì‹ ** (í”„ë¡ íŠ¸ â†’ ë°±ì—”ë“œ, ë°±ì—”ë“œ â†’ DB ë“±) |
| ì¥ì  | ìœ ë™ì ì¸ Pod IPë¥¼ ì¶”ìƒí™”í•˜ì—¬ **ê³ ì •ëœ ì´ë¦„ê³¼ IPë¡œ í†µì‹ ** ê°€ëŠ¥ |
| ë¼ìš´ë“œë¡œë¹ˆ ë°©ì‹ | ì—¬ëŸ¬ Podê°€ ì—°ê²°ë˜ì–´ ìˆì„ ê²½ìš°, ìš”ì²­ì€ ë¬´ì‘ìœ„/ë¼ìš´ë“œë¡œë¹ˆìœ¼ë¡œ ë¶„ì‚°ë¨ |

## ìƒì„±ê³¼ í™•ì¸ ëª…ë ¹ì–´

```bash

kubectl apply -f backend-service.yaml    # ì„œë¹„ìŠ¤ ìƒì„±
kubectl get services                     # ì„œë¹„ìŠ¤ ëª©ë¡ í™•ì¸

```

---

## LoadBalancerë€?

> í´ë¼ìš°ë“œ í™˜ê²½ì—ì„œ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì™¸ë¶€ì— ë…¸ì¶œí•˜ëŠ” ê°€ì¥ ê°„í¸í•œ ë°©ë²•
>
- `NodePort`ëŠ” í´ëŸ¬ìŠ¤í„° ì™¸ë¶€ì—ì„œ ì ‘ê·¼ ê°€ëŠ¥í•˜ì§€ë§Œ,
    - **IP + Port ì¡°í•©ì´ ë³µì¡**
    - **ì‚¬ìš©ì ê²½í—˜ì´ ë–¨ì–´ì§**
- `LoadBalancer`ëŠ” ì™¸ë¶€ì—ì„œ **í•˜ë‚˜ì˜ í¼ë¸”ë¦­ IP**ë¡œ ì ‘ê·¼ ê°€ëŠ¥í•˜ê²Œ í•´ì£¼ëŠ” ì„œë¹„ìŠ¤ íƒ€ì…
    - ì‚¬ìš©ìëŠ” **ë‹¨ì¼ URL ë˜ëŠ” IP**ë§Œ ê¸°ì–µí•˜ë©´ ë¨

## ì‘ë™ ë°©ì‹

[ì‚¬ìš©ì] â†’ [í´ë¼ìš°ë“œ ì œê³µìì˜ Load Balancer (GCP, AWS, Azure)] â†’ [Kubernetes ì„œë¹„ìŠ¤] â†’ [Pod]

- í´ë¼ìš°ë“œ ì œê³µì(GCP, AWS ë“±)ê°€ **í¼ë¸”ë¦­ IP + ë¡œë“œë°¸ëŸ°ì„œ**ë¥¼ ìë™ ìƒì„±
- í•´ë‹¹ IPë¡œ ë“¤ì–´ì˜¤ëŠ” ìš”ì²­ì„ ì ì ˆí•œ Podë¡œ ì „ë‹¬

## êµ¬ì„± ì˜ˆì‹œ

```yaml

apiVersion: v1
kind: Service
metadata:
  name: frontend
spec:
  type: LoadBalancer
  selector:
    app: frontend
  ports:
    - port: 80         # ì™¸ë¶€ì—ì„œ ì ‘ê·¼í•  ì„œë¹„ìŠ¤ í¬íŠ¸
      targetPort: 8080 # ì‹¤ì œ ì»¨í…Œì´ë„ˆ ë‚´ë¶€ í¬íŠ¸

```

- `type: LoadBalancer`ë§Œ ì„¤ì •í•˜ë©´ í´ë¼ìš°ë“œ í™˜ê²½ì—ì„œëŠ” ë¡œë“œë°¸ëŸ°ì„œ ìë™ ìƒì„±
- `kubectl get svc` ëª…ë ¹ì–´ë¡œ **EXTERNAL-IP** í™•ì¸ ê°€ëŠ¥

## NodePortì™€ì˜ ì°¨ì´ì 

| í•­ëª© | NodePort | LoadBalancer |
| --- | --- | --- |
| ë…¸ì¶œ ë°©ì‹ | ë…¸ë“œì˜ IP + ê³ ì • í¬íŠ¸ ì¡°í•© | í¼ë¸”ë¦­ IP ìë™ ìƒì„± |
| ì‚¬ìš©ì ê²½í—˜ | IP:Port ì…ë ¥ í•„ìš” | ë„ë©”ì¸/IP í•˜ë‚˜ë¡œ ì ‘ê·¼ ê°€ëŠ¥ |
| í´ë¼ìš°ë“œ í†µí•© | í•„ìš” ì—†ìŒ (ëª¨ë“  í™˜ê²½ì—ì„œ ì‘ë™) | í´ë¼ìš°ë“œ í™˜ê²½(GCP, AWS ë“±) í•„ìš” |
| ë¡œë“œë°¸ëŸ°ì‹± | ê° ë…¸ë“œë¡œ ìˆ˜ë™ ë¶„ì‚° | í´ë¼ìš°ë“œ ë¡œë“œë°¸ëŸ°ì„œ ìë™ ë¶„ì‚° |

## ì§€ì› í™˜ê²½

- **ì™„ì „í•œ LoadBalancer ê¸°ëŠ¥ì€ í´ë¼ìš°ë“œ í”Œë«í¼(GCP, AWS, Azure)ì—ì„œë§Œ ë™ì‘**
- **Minikube, VirtualBox ê°™ì€ ë¡œì»¬ í™˜ê²½ì—ì„œëŠ” LoadBalancer íƒ€ì…ì„ ì¨ë„ ì‹¤ì œ ì™¸ë¶€ IPëŠ” í• ë‹¹ë˜ì§€ ì•ŠìŒ**
    - ì´ ê²½ìš° **NodePortì²˜ëŸ¼ ë™ì‘í•¨**
    - Minikubeì—ì„  `minikube tunnel` ëª…ë ¹ì–´ë¡œ ì™¸ë¶€ IP í‰ë‚´ ê°€

---

# Namespace

> ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„° ë‚´ì—ì„œ ë¦¬ì†ŒìŠ¤ë“¤ì„ ë…¼ë¦¬ì ìœ¼ë¡œ ê²©ë¦¬í•˜ê¸° ìœ„í•œ ë°©ë²•
>
- í•˜ë‚˜ì˜ í´ëŸ¬ìŠ¤í„° ì•ˆì—ì„œ ì—¬ëŸ¬ **íŒ€, í™˜ê²½(Dev, Prod ë“±)**ì˜ ë¦¬ì†ŒìŠ¤ë¥¼ êµ¬ë¶„í•´ ê´€ë¦¬ ê°€ëŠ¥
- ë„¤ì„ìŠ¤í˜ì´ìŠ¤ëŠ” ì¼ì¢…ì˜ **ê°€ìƒ ê³µê°„(ì§‘)**ì²˜ëŸ¼ ì‘ë™
- ê° ë„¤ì„ìŠ¤í˜ì´ìŠ¤ëŠ” ê³ ìœ í•œ **ì •ì±…, ë¦¬ì†ŒìŠ¤ í• ë‹¹ëŸ‰, ê¶Œí•œ**ì„ ê°€ì§ˆ ìˆ˜ ìˆìŒ

## ê¸°ë³¸ì ìœ¼ë¡œ ì¡´ì¬í•˜ëŠ” namespace

| namespace | ì„¤ëª… |
| --- | --- |
| `default` | ì‚¬ìš©ìê°€ ì•„ë¬´ ê²ƒë„ ì§€ì •í•˜ì§€ ì•Šìœ¼ë©´ ì—¬ê¸°ì— ìƒì„±ë¨ |
| `kube-system` | ì¿ ë²„ë„¤í‹°ìŠ¤ ë‚´ë¶€ ì»´í¬ë„ŒíŠ¸ (DNS, CoreDNS, kube-proxy ë“±) |
| `kube-public` | ëª¨ë“  ì‚¬ìš©ìê°€ ì ‘ê·¼ ê°€ëŠ¥í•œ ë¦¬ì†ŒìŠ¤ (ë³´í†µ ê³µê°œ ì„¤ì •ìš©) |

## ğŸ’¡ ë¹„ìœ : ì´ë¦„ê³¼ ì§‘

- ì§‘ ì•ˆì—ì„œëŠ” â€œë§ˆí¬â€ë¼ê³ ë§Œ ë¶ˆëŸ¬ë„ ë˜ì§€ë§Œ

  ì§‘ ë°–ì—ì„œëŠ” â€œë§ˆí¬ ìŠ¤ë¯¸ìŠ¤â€, â€œë§ˆí¬ ìœŒë¦¬ì—„ìŠ¤â€ì²˜ëŸ¼ ì „ì²´ ì´ë¦„ í•„ìš”

  â†’ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ë„ ë§ˆì°¬ê°€ì§€


```bash

# ë™ì¼ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì—ì„  ë‹¨ìˆœí•œ ì´ë¦„ ê°€ëŠ¥
curl http://db-service

# ë‹¤ë¥¸ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì˜ ì„œë¹„ìŠ¤ì— ì ‘ê·¼ ì‹œ
curl http://db-service.dev.svc.cluster.local

```

## ì‚¬ìš©í•˜ëŠ” ì´ìœ 

| ëª©ì  | ì„¤ëª… |
| --- | --- |
| **í™˜ê²½ ë¶„ë¦¬** | `dev`, `staging`, `prod` ë“± í™˜ê²½ë³„ ë¦¬ì†ŒìŠ¤ ê²©ë¦¬ |
| **íŒ€ ë¶„ë¦¬** | íŒ€ë³„ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ë¡œ ì—­í•  ë° ë¦¬ì†ŒìŠ¤ ì œí•œ ì„¤ì • |
| **ë³´ì•ˆ** | RBAC ì •ì±…ì„ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ë³„ë¡œ ì ìš© ê°€ëŠ¥ |
| **ë¦¬ì†ŒìŠ¤ ì œí•œ** | `ResourceQuota`, `LimitRange`ë¡œ í• ë‹¹ëŸ‰ ì œí•œ |

## ê´€ë ¨ ëª…ë ¹ì–´

| ëª…ë ¹ì–´ | ì„¤ëª… |
| --- | --- |
| `kubectl get pods` | ê¸°ë³¸(default) ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì˜ í¬ë“œ ì¡°íšŒ |
| `kubectl get pods -n dev` | `dev` ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì˜ í¬ë“œ ì¡°íšŒ |
| `kubectl get pods --all-namespaces` | ì „ì²´ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì˜ í¬ë“œ ì¡°íšŒ |
| `kubectl create namespace dev` | `dev` ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ìƒì„± |
| `kubectl config set-context --current --namespace=dev` | í˜„ì¬ ì„¸ì…˜ì„ `dev` ë„¤ì„ìŠ¤í˜ì´ìŠ¤ë¡œ ì„¤ì • |

## ğŸ“„ YAML ì˜ˆì‹œ: namespace ì •ì˜

```yaml

apiVersion: v1
kind: Namespace
metadata:
  name: dev

```

- ì´ íŒŒì¼ë¡œ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ë¥¼ ìƒì„±:

```bash
bash
ë³µì‚¬í¸ì§‘
kubectl apply -f namespace-dev.yaml

```

## ğŸ¯ Podì— Namespace ëª…

```yaml

apiVersion: v1
kind: Pod
metadata:
  name: my-pod
  namespace: dev
spec:
  containers:
    - name: nginx
      image: nginx

```

> ì •ì˜ íŒŒì¼ì—ì„œ metadata.namespaceë¥¼ ì„¤ì •í•˜ë©´ ëª…ì‹œëœ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì— ìƒì„±ë¨
>

## ì •ë¦¬

| ê°œë… | ì„¤ëª… |
| --- | --- |
| ë„¤ì„ìŠ¤í˜ì´ìŠ¤ë€ | í´ëŸ¬ìŠ¤í„° ë‚´ ë¦¬ì†ŒìŠ¤ì˜ ë…¼ë¦¬ì  êµ¬íš |
| ê¸°ë³¸ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ | `default`, `kube-system`, `kube-public` |
| ìƒì„± ë°©ë²• | `kubectl create namespace`, YAML |
| ì ‘ê·¼ ë°©ì‹ | ë™ì¼ ë„¤ì„ìŠ¤í˜ì´ìŠ¤: ê°„ë‹¨í•œ ì´ë¦„ / ë‹¤ë¥¸ ë„¤ì„ìŠ¤í˜ì´ìŠ¤: FQDN |
| ì‚¬ìš© ëª©ì  | ê²©ë¦¬, ë³´ì•ˆ, ìì›ì œí•œ, íŒ€/í™˜ê²½ ë¶„ë¦¬ ë“± |
| DNS ì´ë¦„ ê·œì¹™ | `<ì„œë¹„ìŠ¤ëª…>.<ë„¤ì„ìŠ¤í˜ì´ìŠ¤>.svc.cluster.local` |

---

## Imperative vs Declarative ì ‘ê·¼ë²•

| í•­ëª© | ëª…ë ¹ì  (Imperative) | ì„ ì–¸ì  (Declarative) |
| --- | --- | --- |
| ë°©ì‹ | **ë¬´ì—‡ì„ ì–´ë–»ê²Œ í• ì§€ ëª…ë ¹ì–´ë¡œ ì§ì ‘ ì§€ì‹œ** | **ìµœì¢… ìƒíƒœë§Œ ì„ ì–¸, ë°©ë²•ì€ ì‹œìŠ¤í…œì´ ê²°ì •** |
| ìœ ì‚¬í•œ ì‚¬ë¡€ | íƒì‹œ ê¸°ì‚¬ì—ê²Œ ê¸¸ì„ ì§ì ‘ ì§€ì‹œ | ëª©ì ì§€ë§Œ ì•Œë ¤ì£¼ê³  ìë™ìœ¼ë¡œ ì´ë™ |
| ë„êµ¬ | `kubectl run`, `kubectl edit`, `kubectl set` | `kubectl apply`, YAML ë§¤ë‹ˆí˜ìŠ¤íŠ¸ ì‚¬ìš© |
| ìƒíƒœ ê¸°ë¡ | ê¸°ë¡ë˜ì§€ ì•ŠìŒ (íˆìŠ¤í† ë¦¬ë§Œ ë‚¨ìŒ) | Git ë“±ì—ì„œ ê¸°ë¡ ë° ê´€ë¦¬ ê°€ëŠ¥ |
| ì—ëŸ¬ ì²˜ë¦¬ | ìƒíƒœ í™•ì¸ ì—†ì´ ì‹¤í–‰ â†’ ì¶©ëŒ ë°œìƒ ê°€ëŠ¥ | ì¡´ì¬ ì—¬ë¶€ í™•ì¸ í›„ ìƒì„±/ì—…ë°ì´íŠ¸ ìë™ ì²˜ë¦¬ |
| ì í•©í•œ ìƒí™© | ë¹ ë¥´ê²Œ í…ŒìŠ¤íŠ¸í•˜ê±°ë‚˜ ë‹¨ìˆœ ë¦¬ì†ŒìŠ¤ ìƒì„± ì‹œ | ë³µì¡í•œ ë¦¬ì†ŒìŠ¤ ê´€ë¦¬, ì¸í”„ë¼ ì½”ë“œí™”, í˜‘ì—… |

## ëª…ë ¹ì  ì ‘ê·¼ë²• (Imperative)

### íŠ¹ì§•

- ë¹ ë¥´ê²Œ ëª…ë ¹ì–´ë¥¼ í†µí•´ ë¦¬ì†ŒìŠ¤ë¥¼ ìƒì„±, ìˆ˜ì •, ì‚­ì œ
- í•œ ë²ˆ ì‹¤í–‰í•˜ë©´ ë (YAML íŒŒì¼ ì—†ìŒ)
- ëª…ë ¹ ì˜ˆì‹œ:

    ```bash
    
    kubectl run nginx --image=nginx
    kubectl expose deployment my-app --port=80
    kubectl scale deployment my-app --replicas=3
    kubectl set image deployment/my-app nginx=nginx:1.20
    kubectl edit pod my-pod
    kubectl delete pod my-pod
    
    ```


### ë‹¨ì 

ì¬í˜„/í˜‘ì—… ì–´ë ¤ì›€ (ì–´ë–»ê²Œ ë§Œë“¤ì—ˆëŠ”ì§€ ê¸°ë¡ ì—†ìŒ)

- ì‹¤ìˆ˜ ì‹œ ë¡¤ë°±ì´ë‚˜ ë¹„êµ ë¶ˆê°€
- ì´ë¯¸ ìˆëŠ” ë¦¬ì†ŒìŠ¤ì— ëŒ€í•´ ì¤‘ë³µ ìƒì„± ì‹œ ì˜¤ë¥˜ ë°œìƒ

---

## ì„ ì–¸ì  ì ‘ê·¼ë²• (Declarative)

### íŠ¹ì§•

- ë¦¬ì†ŒìŠ¤ì˜ â€œì›í•˜ëŠ” ìƒíƒœâ€ë¥¼ YAMLë¡œ ì •ì˜
- `kubectl apply -f file.yaml`ë¡œ ìƒì„±/ì—…ë°ì´íŠ¸
- GitOps ë° IaC(Infrastructure as Code)ì— ì í•©
- ì˜ˆì‹œ:

    ```yaml
    
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      name: nginx-deploy
    spec:
      replicas: 3
      template:
        spec:
          containers:
          - name: nginx
            image: nginx:1.20
    
    ```


### ëª…ë ¹ ì˜ˆì‹œ

```bash

kubectl apply -f deployment.yaml      # ìƒì„± ë˜ëŠ” ì—…ë°ì´íŠ¸
kubectl delete -f deployment.yaml     # ì‚­ì œ
kubectl diff -f deployment.yaml       # ì°¨ì´ ë¹„êµ

```

### ì¥ì 

- **ë³€ê²½ ì‚¬í•­ ì¶”ì  ê°€ëŠ¥ (Git ê´€ë¦¬)**
- **ë³€í™”ë§Œ ìë™ìœ¼ë¡œ ë°˜ì˜ë¨ â†’ idempotent**
- **ë³µì¡í•œ ë¦¬ì†ŒìŠ¤ ì •ì˜ ê°€ëŠ¥ (multi-container, env ë“±)**

## ëª…ë ¹ì–´ ì •ë¦¬

| ëª©ì  | ëª…ë ¹í˜• (Imperative) | ì„ ì–¸í˜• (Declarative) |
| --- | --- | --- |
| ë¦¬ì†ŒìŠ¤ ìƒì„± | `kubectl run`, `kubectl create` | `kubectl apply -f <file>` |
| ë¦¬ì†ŒìŠ¤ ìˆ˜ì • | `kubectl edit`, `kubectl set image` | YAML íŒŒì¼ ìˆ˜ì • í›„ `kubectl apply -f` |
| ë¦¬ì†ŒìŠ¤ ì‚­ì œ | `kubectl delete pod mypod` | `kubectl delete -f <file>` |
| ìŠ¤ì¼€ì¼ë§ | `kubectl scale deployment my-app --replicas=3` | YAML ìˆ˜ì • í›„ `apply` |

## ìš”ì•½

> ëª…ë ¹ì  ì ‘ê·¼ë²•ì€ ì†ë„ì— ìœ ë¦¬í•˜ì§€ë§Œ ê¸°ë¡ê³¼ ê´€ë¦¬ì— ì·¨ì•½í•˜ë‹¤.
>
>
> **ì„ ì–¸ì  ì ‘ê·¼ë²•ì€ ì˜ˆì¸¡ ê°€ëŠ¥ì„±ê³¼ í˜‘ì—…ì— ìœ ë¦¬í•˜ê³ , ìœ ì§€ë³´ìˆ˜ê°€ ìš©ì´í•˜ë‹¤.**
>
> **ì‹¤ë¬´ì—ì„  ì„ ì–¸ì  ë°©ì‹ì„ ê¸°ë³¸ìœ¼ë¡œ, ëª…ë ¹ì  ë°©ì‹ì€ ì‹¤í—˜ê³¼ ë””ë²„ê¹… ìš©ë„ë¡œ í™œìš©í•œë‹¤.**
>

---